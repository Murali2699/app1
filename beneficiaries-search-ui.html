<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Payment Automation Dashboard</title>
    <meta content="" name="description">
    <meta content="" name="keywords">
    <!-- Favicons -->
    <link href="assets/img/tn_logo.png" rel="icon">
    <link href="assets/img/tn_logo.png" rel="apple-touch-icon">
    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"> -->
    <link rel="stylesheet" href="assets/vendor/sweetalert2/css/sweetalert.min.css" />
    <link rel="stylesheet" href="assets/vendor/sweetalert2/css/sweetalert2.min.css" />
    <!-- <link rel="stylesheet" href="assets/vendor/toggle/bootstrap-toggle.min.css" /> -->
    <!-- CSS File --> 
    <link href="assets/css/style.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css"> -->
    <script src="assets/components/official_header.js" type="text/javascript" defer></script>
    <style>
      .f600 {
        font-weight: 600;
      }
      .font14 {
    font-size: 14px;
}
        .lbl-color {
            font-weight: 600;
    color: #012970;
        }
        .value-card:nth-child(odd) .card {
            background: #dadcec !important;
}

.badge {
    width: 100px;
}

#beneficiary_search_number {
    color: #012970;
    /* font-weight: 500; */
    font-family: monospace;
    background: #ede0e0;
    text-align: center;
    padding: 0.6rem;
    border-radius: 5px;
}
.ml-2 {
    margin-left: 3px;
    font-size: 0.9rem;
    color: #000;
    padding: 0;
    margin-top: 1rem;
}
    </style>
  </head>
  <body>
    <!-- ======= Header & sidemenu ======= -->
    <official-header-component></official-header-component>
    <div id="preloader"></div>
    <!-- End Sidebar-->
    <main id="main" class="main">
      <!-- Dashboard view starts -->
      <section>
        <div class="container-fluid">
          <div class="card mb-1">
            <form id="formFilters" method="post">
              <div class="card-body pb-0 pt-2">
                <div class="row mb-2 boxflex">
                  <h5 class="card-title pb- mb-0"><i class="bi bi-funnel"></i>  Beneficiaries Search </h5>
                <div class="row mb-2 boxflex">
                  <div class="col-lg-6 col-md-5">
                    <div class="row">
                      <div class="col-md-6">
                        <label for="uid" class="d-flex align-items-baseline"><input type="radio" name="selectType" id="uid" value="uid" checked > <span class="card-title ml-2">Beneficiary's Aadhar no</span> </label>
                      </div>
                      <div class="col-md-6">
                        <label for="beneficiar" class="d-flex align-items-baseline"><input type="radio" name="selectType" id="beneficiar" value="beneficiaryId">  <span class="card-title ml-2">Beneficiary's ID</span></label>
                      </div>
                    </div>                    
                    <!-- <label class="form-label fw-bold" for="uidNumber">Beneficiaries Search</label> -->
                    <input type="search" name="uidNumber" id="uidNumber" class="form-control" placeholder="Enter The Aadhaar Number">
                    <input type="search" name="beneficiariesid" id="beneficiariesid" class="form-control" placeholder="Enter The Beneficiary Id" style="display: none;">
                  </div>
                  <div class="col-lg-2 col-md-2">
                    <button class="btn btn-success float-end cbtn mt-4" type="submit" id="reset_div"><i class="bi bi-pencil-square" id="btnGetFilter"></i> Submit</button>
                  </div>
                  
                  <div class="col-lg-4 col-md-4" id="form_info" style="display:none">
                    <label class="form-label fw-bold" id="search_type_lable"> Beneficiary Id</label>
                    <h3 id="beneficiary_search_number"></h3>
                  </div>
                </div>
              </div>
              <input type="hidden" name="approvelpayment" id="approvelpayment">
              <input type="hidden" name="user_id" id="UserID">
            </form>
          </div>
          <!-- END: Dropdown card end here -->
          
          </div>

          <div class=" mb-2">
            <div class="">
              <div class="row show-values"> 
                <div class="col" id="beneficiary_list"></div>
              </div>
            </div>
          </div>

          <!-- END: list card end here -->
          <!-- START: modal popup -->
          <!-- Button trigger modal -->
        </div>
      </section>
    </main>
    <!-- End #main -->
    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
      <div class="copyright">
        &copy; Copyright <strong><span>TNeGA</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        Designed & Developed by <a href="https://tngis.tn.gov.in/" target="_blank">TNeGA</a>
      </div>
    </footer>
    <!-- End Footer -->
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
    <!-- Delete modal starts -->
    <!-- view crop info ends -->
    <!-- Vendor JS Files -->

    <div class="modal fade viewdatainfo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
        <div class="modal-content">
          <div class="modal-header py-2">
            <h1 class="modal-title fs-5" id="exampleModalLabel"><i class="bi bi-file-earmark-person"></i> Beneficiary Scheme Wise Transcation</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body py-2">
            <div class="card p-3 bg-info-light">
              <div class="row">
                <div class="col"><label for="">Scheme Name : <span id="popup_txt_schmename"></span></label></div>
                <div class="col"><label for="">Beneficiaries Name : <span id="popup_txt_name"></span></label></div>
                <div class="col"><label for="">Beneficiaries Mobile No : <span id="popup_txt_mobile"></span></label></div>
              </div>
            </div>
           
            <table class="table table-striped w-100 no-footer dataTable mt-3" id="tblBeneficiaryViewList" aria-describedby="tblBeneficiaryViewList_info">
              <thead>
                 <tr>
                  <!-- { "data": "action_by" },
            { "data":"bank_details" },
            { "data": "payment_initiated_date" },
            { "data": "paid_date"},
            { "data": "payment_mode"},
            { "data": "amount"},
            { "data": "payment_status"}, -->

                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="S.No: activate to sort column descending" aria-sort="ascending">S.No</th>
                    
                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="scheme name: activate to sort column descending" aria-sort="ascending">Action By</th>

                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="scheme name: activate to sort column descending" aria-sort="ascending">Bank Details</th>

                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="scheme name: activate to sort column descending" aria-sort="ascending">Year Month</th>

                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="scheme name: activate to sort column descending" aria-sort="ascending">Payment Initiated Date</th>
                    
                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="scheme name: activate to sort column descending" aria-sort="ascending">Paid Date</th>

                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="scheme name: activate to sort column descending" aria-sort="ascending">Paid Mode</th>

                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="scheme name: activate to sort column descending" aria-sort="ascending">Amount</th>

                    <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBeneficiaryViewList" aria-label="status: activate to sort column descending" aria-sort="ascending"> Status </th>
                 </tr>                                 
              </thead>
              <tbody>
                <!-- <tr>
                  <td>1</td>
                  <td>DDO - Nagarajan</td>
                  <td>2024-02-01</td>
                  <td>1000</td>
                  <td>
                    <label for="" class="badge bg-success"> Success</label>
                  </td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>DDO - Raja sekar</td>
                  <td>2024-02-01</td>
                  <td>1000</td>
                  <td>
                    <label for="" class="badge bg-warning"> Pending</label>
                  </td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>DDO - Mani krishnan</td>
                  <td>2024-02-01</td>
                  <td>1000</td>
                  <td>
                    <label for="" class="badge bg-info"> Inprogress</label>
                  </td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>DDO - Sangara Narayanan</td>
                  <td>2024-02-01</td>
                  <td>1000</td>
                  <td>
                    <label for="" class="badge bg-danger"> Rejected </label>
                    <i type="button" class="bi bi-info-circle-fill  text-danger" data-toggle="tooltip" data-placement="top" title="A/c Blocked or Frozen"></i>
                  </td>
                </tr> -->
              </tbody>
           </table>
            <div id="env_detials"></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    
    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script type="text/javascript" src="assets/vendor/jquery-validate/js/jquery.validate.min.js"></script>
    
    <!-- Main JS File -->
    
    <script src="assets/js/global.js"></script>
    <script src="assets/js/base64tojson.js"></script>
    <script src="assets/js/crypto-js.js"></script>
    <script src="assets/js/aes.js"></script>
  

    <script type="text/javascript" src="assets/vendor/toastr/toastr.min.js"></script>
    
    <!-- Crypto js -->
    <script src="assets/vendor/encryption/crypto-js.min.js"></script>
    <!-- Encryption js -->
    <script src="assets/vendor/encryption/Encryption.js"></script>
    <script src="assets/vendor/sweetalert2/js/sweetalert2.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script type="text/javascript">
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    </script>

<script src="assets/vendor/datatable/jquery.dataTables.min.js"></script>
<script src="assets/vendor/datatable/dataTables.bootstrap5.min.js"></script>
<script type="text/javascript" src="assets/vendor/datatable/js/dataTables.js"></script>
<script type="text/javascript" src="assets/vendor/datatable/js/dataTables.bootstrap4.js"></script>
<script src="assets/vendor/datatables-buttons/js/dataTables.buttons.min.js"></script>
<script src="assets/vendor/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
<script src="assets/vendor/datatables-buttons/js/jszip.min.js"></script>
<script src="assets/vendor/datatables-buttons/js/pdfmake.min.js"></script>
<script src="assets/vendor/datatables-buttons/js/vfs_fonts.js"></script>
<script src="assets/vendor/datatables-buttons/js/buttons.html5.min.js"></script>
<script src="assets/vendor/datatables-buttons/js/buttons.print.min.js"></script>
<script src="assets/vendor/datatables-buttons/js/buttons.colVis.min.js"></script>
<script src="assets/vendor/sweetalert2/js/sweetalert.min.js"></script>
<script src="assets/vendor/sweetalert2/js/sweetalert2.all.min.js"></script>
<script src="assets/vendor/toggle/bootstrap-toggle.min.js"></script>
<script src="assets/js/global.js"></script>
<script src="assets/js/alpinejs_3_10_2.min.js" defer></script>
<script src="assets/lang/reports.js"></script>
<script src='https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js'></script>
<script src="assets/scripts/xlsx.full.min.js"></script>
    
 
 <script type="text/javascript">
  var url = window.location.href;
  var page_url = url.split('/');
  var page = page_url[4];
  
  var userDataString = getCookie('payment_official');
  userDataString = JSON.parse(userDataString);
  $(document).ready(function () {
  
    $(document).on({
           ajaxStart: function () {
             $('#preloader').show();
            //  console.log('preloader is show');
           },
           ajaxStop: function () {
             $('#preloader').hide();
            //  console.log('preloader is show');
           }
         });
  
    $('.official').each(function (i, obj) {
      var href = obj.getAttribute("href");
      if (href == page) {
        obj.classList.add('active');
      } else {
        obj.classList.remove('active');
      }
    });
    // $('#preloader').hide();
    
    var userDataString = getCookie('payment_official');
    if (!userDataString) {
      $('#preloader').show();
      window.location.href = "login.html";
    }
  
    userDataString = JSON.parse(userDataString);
    $('#official_username').text(userDataString['first_name']);
    $('#UserID').val(userDataString['user_id']);
    window.loginUser_id = userDataString['user_id'];


    reloID = userDataString['role_id'];
    roleBasedPageAllow(loginUser_id,reloID);
    
   

  });
  
  function getCookie(name) {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.startsWith(name + '=')) {
          return cookie.substring(name.length + 1);
        }
      }
      return null;
    }
  
  /* filters */
  
    $('#form_info').hide();

    /*END : Get Taluk list*/
  // });
  var formsFilter = [];
  window.localStorage.removeItem('filters');
  /*from submit*/
  $(document).ready(function() {
    
    $("#formFilters").validate({
            rules: {
              uidNumber: {
                required: true,
                minlength: 12, // Minimum length of 12 digits
                maxlength: 12 , // Maximum length of 12 digits
                twelveDigits: true,
                Verhoeff:true
              },
              beneficiariesid:{required: true}
              
            },
            messages: {
              uidNumber: {
                required: "Enter the Aadhar Number",
                minlength: "Aadhar ID must be exactly 12 digits long",
                maxlength: "Aadhar ID must be exactly 12 digits long"
              },
              beneficiariesid:{ required: "Enter the Beneficiary id",}
            },
            errorClass: "help-inline text-danger",
            errorElement: "span",
            highlight: function(element, errorClass, validClass) {
                $(element).parents('.form-group').addClass('has-error');
            },
            unhighlight: function(element, errorClass, validClass) {
                $(element).parents('.form-group').removeClass('has-error');
                $(element).parents('.form-group').addClass('has-success');
            },
            submitHandler: function(form,e) {
              $('#form_info').hide();
                e.preventDefault();
                // console.log('Form submitted');
                formsFilter.length = 0;
                formsFilter = [];
                var formData = $(form).serialize();

                var secretKey = CryptoJS.lib.WordArray.random(16); // 128 bits (16 bytes) for AES-128
                var iv = CryptoJS.lib.WordArray.random(16); // 128 bits (16 bytes) IV

                // Convert the key and IV to hexadecimal strings for transmission
                var secretKeyHex = CryptoJS.enc.Hex.stringify(secretKey);
                var ivHex = CryptoJS.enc.Hex.stringify(iv);

                // Encrypt the password using the generated key and IV
                var encryptedString = encrypt(formData, secretKey, iv);

                // var queryString = $.param(formData);\
                // var encodedData = encodeURIComponent(queryString);
                window.localStorage.removeItem('filters');
                // window.localStorage.setItem('filters', JSON.stringify(formData));
                  $.ajax({
                      url: APIURL + 'beneficiaryidbasedlist', // Replace with your API endpoint
                      method: 'POST', // Change the method to GET
                      headers: {
                          'X-APP-KEY': config.app_key,
                          'X-APP-NAME': config.app_name
                      },
                      data: {
                        fileters:encryptedString,
                        secretKeyHex:secretKeyHex,
                        ivHex:ivHex,
                        user_id:loginUser_id
                      },
                      dataType: 'json',
                      success: function (response) {
                              let outputObject = [];

                              $('#beneficiary_search_number').text('');
                                  let currentuidNumber = $('#uidNumber').val();
                                  let beneficiariesid = $('#beneficiariesid').val();
                                  $('#form_info').show();
                                  if(currentuidNumber !=''){
                                    $('#search_type_lable').text('Search By Aadhar Number');
                                    $('#beneficiary_search_number').text(currentuidNumber);
                                  }else if(beneficiariesid!=''){
                                    $('#search_type_lable').text('Search By Beneficiary ID');
                                    $('#beneficiary_search_number').text(beneficiariesid);
                                  }

                              $(beneficiary_list).html('');
                              let cardList='';
                              if (response.success == 1) {
                                let output = response.data
                                

                                let beneficiaridParam ='';
                                let user_id =$('#UserID').val();

                                let enterUid = $('#uidNumber').val();
                                let enterBid = $('#beneficiariesid').val();
                                if(enterUid !=''){ 
                                  beneficiaridParam = enterUid;
                                  $('#uidNumber').val('');
                                }else if(enterBid!=''){
                                  beneficiaridParam = enterBid;
                                  $('#beneficiariesid').val('')
                                }

                                output.forEach(beneficiary => {
                                  let benificiary_mobile_no='-----------';
                                  if(beneficiary.benificiary_mobile_no!=null){
                                    benificiary_mobile_no = beneficiary.benificiary_mobile_no;
                                  }
                                    cardList += `<div class="col-lg-12 align-items-stretch mb-2 mt-2 value-card">
                                    <div class="card   h-100">
                                    <div class="card-body">

                                      <div class="row">
                                        <h5 class="text-primary mb-0 mt-2 col-lg-12"><i class="bi bi-check2-circle"></i> ${beneficiary.scheme_category} - <small class="text-danger font14 f600"> ${beneficiary.scheme_name} - ${beneficiary.subscheme_name}</small></h5> 
                                        
                                
                                        
                                      </div>

                                    <div class="row befify-info mt-2 text-center">
                                    <div class="col-lg-4">
                                    <label class="lbl-color">Beneficiaries Name</label>
                                    <label class="d-block">${beneficiary.benificiary_name}</label>
                                    </div>
                                    <div class="col-lg-4">
                                    <label class="lbl-color">Beneficiaries Mobile</label>
                                    <label class="d-block">+91 ${benificiary_mobile_no}</label>
                                    </div>
                                    <div class="col-lg-4">
                                    <label class="lbl-color">Action</label>
                                    <label class="d-block">
                                    <a href="javascript:void(0);" class="badge text-bg-primary c-pointer" data-bs-toggle="modal" data-bs-target=".viewdatainfo" onclick="viewSchemeBasedBeneficiary(${beneficiary.scheme_id},${beneficiaridParam},${user_id},'${beneficiary.scheme_category}','${beneficiary.benificiary_name}','${benificiary_mobile_no}')"><i class="bi bi-eye"></i> view</a>
                                    </label>
                                    </div>
                                    </div>
                                    </div>
                                    </div>
                                    </div>`;
                                });
                    

                    $(beneficiary_list).html(cardList);
                              
                                
                          } else if (response.success == 0) {
                            $('#beneficiariesid').val('');
                            $('#uidNumber').val('');
                            cardList += `<div class="col-lg-12 align-items-stretch mb-2 mt-2 value-card">
                    <div class="card   h-100">
                      <div class="card-body">
                       <h3 class="text-center mt-4"> ${response.message} ...! </h3>
                      </div>
                    </div>
                  </div>`;

                    $(beneficiary_list).html(cardList);
                          }
                      },
                      error: function () {
                        Swal.fire({
                            icon: "error",
                            title: "Service Error!",
                            showConfirmButton: false,
                            timer: 2000
                        })
                      }
                    });

                

                // $('#formFilters')[0].reset();

                // getDashboard();
                return false;
            }
      });



        $.validator.addMethod("twelveDigits", function(value, element) {
        return /^\d{12}$/.test(value); // Test if value contains exactly 12 digits
        }, "Please enter exactly 12 digits.");

        $.validator.addMethod("Verhoeff", function(value, element) {
          let values = value.toString();
          console.log(value);
          console.log(typeof value);
          console.log(values);
          console.log(typeof values);
        return checkUID(values); // Test if value contains exactly 12 digits
        }, "Please enter exactly aadhar number.");
      

  });


  function viewSchemeBasedBeneficiary(scheme_id,beneficiarid,userid,scheme_cate,beneficiar_name,mobile_no){
  $('#popup_txt_schmename').text('');
  $('#popup_txt_name').text('');
  $('#popup_txt_mobile').text('');

  $('#popup_txt_schmename').text(scheme_cate);
  $('#popup_txt_name').text(beneficiar_name);
  $('#popup_txt_mobile').text('+91 '+mobile_no);
  
    $('#tblBeneficiaryViewList').DataTable().clear().destroy();
    $('#tblBeneficiaryViewList').DataTable({
        "aLengthMenu": [10, 25, 50,100],
        "pageLength": -1,
        "footer": true,
        "dom": 'Bfrtip',
        "buttons": [
              {
                    extend: 'csv',
                    text: 'CSV',
                    filename: 'Payment Lists',
                    exportOptions: {
                        rows: ':visible', // Export visible rows
                        modifier: {
                            selected: null // Export all rows, not just selected
                        }
                    }
                },
                {
                    extend: 'excel',
                    text: 'Excel',
                    filename: 'Payment Lists' // Set custom filename for Excel
                }
        ],
        "searching": true,
        "processing": true,
        "serverSide": true,
        "ajax": {
            "url": APIURL + 'beneficiary_search_view_popup',
            "type": "POST",
            "headers": { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
            "dataType": "JSON",
            data: {
              scheme_id:scheme_id,
              beneficiarid:beneficiarid,
              user_id:userid
            },
          "beforeSend": function () {
            // $('#preloader').show();
            $('#preloader').hide();
            tblPreloaderEnable('tblBeneficiaryViewList');
          },
          "error": function (xhr, error, thrown) {
                Swal.fire({
                    icon: "error",
                    title: 'Service Error !',
                    showConfirmButton: false,
                    timer: 2000
                });
            },
            "dataSrc": 'data',
          },
        "columns": [
            { "data": "S.No", render: function (data, type, row, meta) {
                return meta.row + meta.settings._iDisplayStart + 1;
                }
            },
            { "data": "action_by" },
            { "data":"bank_details" },
            { "data":"yyyymm" },
            { "data": "payment_initiated_date" },
            { "data": "paid_date"},
            { "data": "payment_mode"},
            { "data": "amount"},
            // { "data": "payment_status"},
            { "data": function (data, type, row, meta) {
            let status = '';
              if(data.payment_status =='Success'){
                status = '<span class="badge bg-success">'+data.payment_status+'</span>';
              }else if(data.payment_status =='In Progress'){
                status = '<span class="badge bg-info">'+data.payment_status+'</span>';
              }else if(data.payment_status =='Failed'){
                status = `<label for="" class="badge bg-danger"> ${data.payment_status} </label>
                    <i type="button" class="bi bi-info-circle-fill  text-danger" data-toggle="tooltip" data-placement="top" title="Reason Code : ${data.failure_reason_code} / Reason : ${data.failure_reason}"></i>`;'<span class="badge bg-danger">'+data.payment_status+'</span>';
              }
                return status;
              }
            },
            
        ],
        "drawCallback": function (settings) {
        },
        "initComplete": function (settings, json) {
                $('#preloader').hide();
                totalgetReportRecords = json.recordsTotal;
                $('#accordionExample .accordion-collapse').collapse('hide');
        }
    }); 
  }




  function checkUID(uid) {
    if (uid.length != 12) {
        return false;
    }

    var Verhoeff = {
        "d": [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            [1, 2, 3, 4, 0, 6, 7, 8, 9, 5],
            [2, 3, 4, 0, 1, 7, 8, 9, 5, 6],
            [3, 4, 0, 1, 2, 8, 9, 5, 6, 7],
            [4, 0, 1, 2, 3, 9, 5, 6, 7, 8],
            [5, 9, 8, 7, 6, 0, 4, 3, 2, 1],
            [6, 5, 9, 8, 7, 1, 0, 4, 3, 2],
            [7, 6, 5, 9, 8, 2, 1, 0, 4, 3],
            [8, 7, 6, 5, 9, 3, 2, 1, 0, 4],
            [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]],
        "p": [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            [1, 5, 7, 6, 2, 8, 3, 0, 9, 4],
            [5, 8, 0, 3, 7, 9, 6, 1, 4, 2],
            [8, 9, 1, 6, 0, 4, 3, 5, 2, 7],
            [9, 4, 5, 3, 1, 2, 6, 8, 7, 0],
            [4, 2, 8, 6, 5, 7, 3, 9, 0, 1],
            [2, 7, 9, 3, 8, 0, 6, 4, 1, 5],
            [7, 0, 4, 6, 9, 1, 3, 2, 5, 8]],
        "j": [0, 4, 3, 2, 1, 5, 6, 7, 8, 9],
        "check": function (str) {
            var c = 0;
            var str = this.toString(); // Convert 'this' to a string
            str.replace(/\D+/g, "").split("").reverse().join("").replace(/[\d]/g, function (u, i) {
                c = Verhoeff.d[c][Verhoeff.p[i % 8][parseInt(u, 10)]];
            });
            return c;

        },
        "get": function (str) {

            var c = 0;
            var str = this.toString(); // Convert 'this' to a string
            str.replace(/\D+/g, "").split("").reverse().join("").replace(/[\d]/g, function (u, i) {
                c = Verhoeff.d[c][Verhoeff.p[(i + 1) % 8][parseInt(u, 10)]];
            });
            return Verhoeff.j[c];
        }
    };

    String.prototype.verhoeffCheck = (function () {
        var d = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            [1, 2, 3, 4, 0, 6, 7, 8, 9, 5],
            [2, 3, 4, 0, 1, 7, 8, 9, 5, 6],
            [3, 4, 0, 1, 2, 8, 9, 5, 6, 7],
            [4, 0, 1, 2, 3, 9, 5, 6, 7, 8],
            [5, 9, 8, 7, 6, 0, 4, 3, 2, 1],
            [6, 5, 9, 8, 7, 1, 0, 4, 3, 2],
            [7, 6, 5, 9, 8, 2, 1, 0, 4, 3],
            [8, 7, 6, 5, 9, 3, 2, 1, 0, 4],
            [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]];
        var p = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            [1, 5, 7, 6, 2, 8, 3, 0, 9, 4],
            [5, 8, 0, 3, 7, 9, 6, 1, 4, 2],
            [8, 9, 1, 6, 0, 4, 3, 5, 2, 7],
            [9, 4, 5, 3, 1, 2, 6, 8, 7, 0],
            [4, 2, 8, 6, 5, 7, 3, 9, 0, 1],
            [2, 7, 9, 3, 8, 0, 6, 4, 1, 5],
            [7, 0, 4, 6, 9, 1, 3, 2, 5, 8]];

        return function () {
            var c = 0;
            this.toString().replace(/\D+/g, "").split("").reverse().join("").replace(/[\d]/g, function (u, i) {
                c = d[c][p[i % 8][parseInt(u, 10)]];
            });
            return (c === 0);
        };
    })();

    if (Verhoeff['check'](uid) === 0) {
        return true;
    } else {
        return false;
    }
}
  
  
  function populateDropdown(dropdownId, data, fieldName) {
      const dropdown = document.getElementById(dropdownId);
  
      // Populate options from data
      data.forEach(item => {
        const option = document.createElement('option');
        option.value = item[fieldName + '_code'];
        option.textContent = item[fieldName + '_name'];
        dropdown.appendChild(option);
      });
    }
  
  

    function numberWithCommas(x) {
      return x.toLocaleString('en-IN');
    }

    function numberWithCurrency(x){
      return  x.toLocaleString('en-IN', {maximumFractionDigits: 0, style: 'currency',currency: 'INR'});
    }

    $(document).ready(function() {
      // Initialize tooltips
      $('[data-toggle="tooltip"]').tooltip({
          html: true, // Enable HTML content in the tooltip
          // Show dynamic content when the tooltip is shown
          title: function() {
              return $(this).data('content');
          }
      });
    });


    $('input[name="selectType"]').on('change',function(){
      let checkboxValue = $(this).val();
      if(checkboxValue =='uid'){
        // disable
        elementInputEmpty('beneficiariesid');
        hideInputElement('beneficiariesid');
        hideInputElement('beneficiariesid-error');
      //  active
        showInputElement('uidNumber');
      }else if(checkboxValue == 'beneficiaryId'){
        elementInputEmpty('uidNumber');
        hideInputElement('uidNumber');
        hideInputElement('uidNumber-error');
        showInputElement('beneficiariesid');
      }
    })
    
    hideInputElement('beneficiariesid');

    function hideInputElement(elementId){
      $('#'+elementId).prop('disable', true);
        $('#'+elementId).hide();
       
    }

    function showInputElement(elementId){
      $('#'+elementId).prop('disable', false);
        $('#'+elementId).show();
    }

    function elementInputEmpty(elementId){
      $('#'+elementId).val('');
    }

    function tblPreloaderEnable(tableName){
      var processingDiv = document.getElementById(tableName+'_processing');
      var displayStatus = window.getComputedStyle(processingDiv).display;
      if (displayStatus === 'block') {
      $('#'+tableName+'_processing').html(`<div id="preloader"></div>`);
      } else {
        $('#'+tableName+'_processing').text(`<div id="preloader"></div>`);
      }
}


  function encrypt(data, key, iv) {
    return CryptoJS.AES.encrypt(data, key, {
      iv: iv,
      mode: CryptoJS.mode.CBC,
      padding: CryptoJS.pad.Pkcs7
    }).toString();
  }

  </script>
  </body>
  </html>