<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Payment Automation Dashboard</title>
    <meta content="" name="description">
    <meta content="" name="keywords">
    
    <link href="assets/img/tn_logo.png" rel="icon">
    <link href="assets/img/tn_logo.png" rel="apple-touch-icon">
    <link href="https:
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
     
    <link href="assets/css/style.css" rel="stylesheet">
    <official-header-component></official-header-component>
    <div id="preloader"></div> 
    <main id="main" class="main">
      
      <section>
        <div class="container-fluid">
          <div class="card mb-1">
            
            <form id="formFilters" method="post">
                <div class="card-body pb-0 pt-2">
                   <div class="accordion" id="accordionExample">
                      <div class="accordion-item">
                         <h2 class="accordion-header">
                            <button id="btnfilter" style="    background: linear-gradient(to right, rgb(44 43 88), rgb(34 25 111)) !important;
                               color: #fff !important;" class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            <i class="bi bi-funnel"></i>  <span class="px-2">Report Filter</span>
                            </button>
                         </h2>
                         <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                            <div class="accordion-body w-100">
                               <div class="row mb-2 boxflex">
                                  
                                  <div class="col-md-3">
                                     <label for="ddl_scheme_cate" class="form-label fw-bold">Scheme category</label>
                                     <select class="form-select" id="ddl_scheme_cate" name="ddl_scheme_cate">
                                        <option value="">--All--</option>
                                     </select>
                                  </div>
                                     <label for="ddl_scheme_code" class="form-label fw-bold">Scheme Code</label>
                                     <select class="form-select" id="ddl_scheme_code" name="ddl_scheme_code"><option value="">--All--</option></select>
                                     <label for="ddl_scheme_name" class="form-label fw-bold">Scheme Name</label>
                                     <select class="form-select" id="ddl_scheme_name" name="ddl_scheme_name">
                                        <option value="">--Select--</option>
                                     <label for="ddl_sub_scheme" class="form-label fw-bold">Sub Scheme Name</label>
                                     <select class="form-select" id="ddl_sub_scheme" name="ddl_sub_scheme">
                                     <label for="ddl_department" class="form-label fw-bold">Department</label>
                                     <select class="form-select" id="ddl_department" name="ddl_department">
                                     <label for="ddl_sub_department" class="form-label fw-bold">Sub Department</label>
                                     <select class="form-select" id="ddl_sub_department" name="ddl_sub_department">
                               </div>
                               <hr>
                                 <div class="row mb-2 boxflex">
                                  <div class="col-md" id="ddl_payment_cycle_col">
                                    <label for="from_date" class="form-label fw-bold mt-3">Payment Cycle</label>
                                    <p id="ddl_payment_cycle">Scheme Based Payment Period</p>
                                  <div class="col-md" id="ddl_payment_period_col">
                                    <label for="from_date" class="form-label fw-bold">Select Payment Period</label>
                                    <select name="ddl_payment_period" id="ddl_payment_period" class="form-select">
                                      <option value="" disabled selected>Select Payment Period</option>
                                    </select>
                                  <div class="col-md" id="ddl_payment_installment_col">
                                    <label for="from_date" class="form-label fw-bold">Select Installment</label>
                                    <select name="ddl_payment_installment" id="ddl_payment_installment" class="form-select">
                                      <option value="" disabled selected>Select Installment</option>
                                  <div class="col-md" id="ddl_year_col">
                                    <label for="to_date" class="form-label fw-bold">Select Year - Month</label>
                                    <select name="ddl_year" id="ddl_year" class="form-select" data-live-search="true">
                                      <option value="" disabled selected>Select Year and month</option>
                                </div>
                                 <hr>
                                 <div class="row boxflex mb-3">
                                   <div class="col">
                                     <label for="ddl_district" class="form-label fw-bold">District</label>
                                     <select class="form-select" id="ddl_district" name="ddl_district" data-live-search="true"><option value="">--ALL--</option></select>
                                   </div>
                                     <label for="ddl_taluk" class="form-label fw-bold">Taluk</label>
                                     <select class="form-select" id="ddl_taluk" name="ddl_taluk" data-live-search="true"><option value="">--ALL--</option></select>
                                   </div>                                  
                                 </div>
                                  <button class="btn btn-success float-end cbtn col-md-2" type="submit"><i class="bi bi-pencil-square"></i> Submit</button>
                            </div>
                         </div>
                      </div>
                   </div>
                </div>
                <input type="hidden" name="current_tab_value" id="current_tab_value" value="0">
                <input type="hidden" name="approvelpayment" id="approvelpayment">
                <input type="hidden" name="payment_date_input" id="payment_date_input">
              <input type="hidden" name="payment_cycle_hidden" id="payment_cycle_hidden">
              <input type="hidden" name="installment_txt_value" id="installment_txt_value">
              
                <input type="hidden" name="pamentbooleanSet" id="pamentbooleanSet">
             </form>
          </div>
          
          <div class="card mb-1 mt-2" id="filter_based_info_card_div">
            <div class="card-body pb-0 pt-2 bg-info-light">
              <div class="row">
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Scheme Category</label>
                  <p id="lable_text_scheme_cate" class="text-left font-custom-text">KMUT</p>
                  <label class="form-label fw-bold font-custom-lable">Scheme Code</label>
                  <p id="lable_text_scheme_code" class="text-left font-custom-text">CD94U</p>
                
                  <label class="form-label fw-bold font-custom-lable">Scheme Name</label>
                  <p id="lable_text_scheme" class="text-left font-custom-text">KALAINGAR MAHALIR URIMAI THITTAM</p>
                  <label class="form-label fw-bold font-custom-lable">Sub Scheme Name</label>
                  <p id="lable_text_sub_scheme" class="text-left font-custom-text">kmut</p>
                  <label class="form-label fw-bold font-custom-lable">Department</label>
                  <p id="lable_text_Department" class="text-left font-custom-text">Revenue And Disaster Management Department</p>
              </div>
                  <label class="form-label fw-bold font-custom-lable">Sub Department</label>
                  <p id="lable_text_sub_department" class="text-left font-custom-text">Revenue Administration</p>
                  <label class="form-label fw-bold font-custom-lable">Payment Year-month</label>
                  <p id="lable_text_year_month" class="text-left font-custom-text"></p>
                  <label class="form-label fw-bold font-custom-lable">Payment Period</label>
                  <p id="lable_text_payment_period" class="text-left font-custom-text"></p>
                  <label class="form-label fw-bold font-custom-lable">installment</label>
                  <p id="lable_text_installment" class="text-left font-custom-text"></p>
                  <label class="form-label fw-bold font-custom-lable">Payment Date</label>
                  <select name="label_payment_date" id="label_payment_date" class="form-select text-center mb-2">
                    <option value="" disabled selected>Payment Date Not Found</option>
                  </select>
              </div>                   
            </div>

          <div class="card mb-2 mt-3" id="tblCard">
            <div class="card-body">
              <ul class="nav nav-tabs my-3 active" id="myTab" role="tablist">
                <li class="nav-item mx-2" role="presentation">
                  <button class="nav-link active" id="disabled-tab1" data-bs-toggle="tab" data-bs-target="#inprogress-tab-pane" type="button" role="tab" aria-controls="inprogress-tab-pane" aria-selected="false" value="3" onclick="tabClickValue(3)">Payment In-Progress</button>
                </li>
                  <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#payment-success-tab-pane" type="button" role="tab" aria-controls="payment-success-tab-pane" aria-selected="false" onclick="tabClickValue(1)">Payment Success</button>
                <li class="nav-item" role="presentation">
                    <button class="nav-link mx-2" id="disabled-tab" data-bs-toggle="tab" data-bs-target="#payment-report-summary-tab-pane" type="button" role="tab" aria-controls="payment-report-summary-tab-pane" aria-selected="false" value="2" onclick="tabClickValue(8)">Payment Summary Report</button>
                    <button class="nav-link mx-2" id="disabled-tab" data-bs-toggle="tab" data-bs-target="#payment-failure-summary-tab-pane" type="button" role="tab" aria-controls="payment-failure-summary-tab-pane" aria-selected="false" value="2" onclick="tabClickValue(9)">Payment Failure Reason wise Summary Report</button>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link mx-2" id="disabled-tab" data-bs-toggle="tab" data-bs-target="#payment-filewise-summary-tab-pane" type="button" role="tab" aria-controls="payment-filewise-summary-tab-pane" aria-selected="false" value="2" onclick="tabClickValue(10)">Payment File wise Summary Report</button>
              </ul>
              <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade" id="payment-success-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
                  <div class="col-lg-12">
                    <div class="card1">
                      <div class="card-body1">
                        <h5 class="card-title mt-3 mb-0"><i class="bi bi-check2-circle"></i>  Payment Success </h5>
                        <div class="clear-both"></div>
                        <div class="col-lg-12 mt-2 clear-both" style="clear: both;">
                          <div class="table-responsive">
                            <table class="table" class="table table-striped w-100 no-footer dataTable mt-3" id="tblPaymentSuccessList" aria-describedby="tblPaymentSuccessList_info">
                              <thead>
                                <tr>
                                  <th scope="col"  class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">S.No</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Scheme</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Year</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Month </th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Beneficiary Name</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Mobile No</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">ACH / ABP</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Installment</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Amount</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Transcation Date</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentSuccessList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Action</th>
                                </tr>
                              </thead>
                              <tbody>
                              </tbody>
                            </table>
                          </div>
                        </div>
                    </div>
                  </div>
                <div class="tab-pane fade show active" id="inprogress-tab-pane" role="tabpanel" aria-labelledby="disabled-tab" tabindex="0">
                        <div id="dynamic_heading"></div>
                        <h5 class="card-title mt-3 mb-0"><i class="bi bi-check2-circle"></i> 
                          Payment In-Progress
                        </h5>
                        <div class="col-lg-12 mt-2 clear-both" style="    clear: both;">
                            
                            <table class="table" class="table table-striped w-100 no-footer dataTable mt-3" id="tblPaymentInprogressList" aria-describedby="tblPaymentInprogressList_info">
                                  <th scope="col"  class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">S.No</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Scheme</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Year</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Month </th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Beneficiary Name</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Mobile No</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">ACH / ABP</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Installment</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Amount</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Transcation Date</th>
                                  <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentInprogressList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Action</th>
                                
                <div class="tab-pane fade" id="payment-report-summary-tab-pane" role="tabpanel" aria-labelledby="disabled-tab" tabindex="0">
                    <div class="col-lg-12">
                      <div class="card1">
                        <div class="card-body1">
                            <h5 class="card-title mt-3 mb-0"><i class="bi bi-check2-circle"></i>  Payment Summary Report</h5>
                            <label for="checkTaluk" id="checkTaluk_lable"><input type="checkbox" name="taluk" id="checkTaluk"> Taluk Wise Report</label>
                            <div class="clear-both"></div>
                            <div class="col-lg-12 mt-2 clear-both" style="    clear: both;">
                              <div class="table-responsive cus-grid">
                                 <table class="table table-striped w-100 no-footer dataTable mt-3" id="tblPaymentReportsList" aria-describedby="tblPaymentReportsList_info">
                                    <thead>
                                       <tr>
                                          <th class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentReportsList" aria-label="S.No: activate to sort column descending" aria-sort="ascending" rowspan="3">S.No</th>
                                          <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentReportsList" aria-label="district: activate to sort column descending" aria-sort="ascending" rowspan="3">District</th>
                                          <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentReportsList" aria-label="taluk: activate to sort column descending" aria-sort="ascending" rowspan="3" id="tblPaymentReportsList_taluk">Taluk</th>
                                          <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentReportsList" aria-label="received: activate to sort column descending" aria-sort="ascending" rowspan="3">received date</th>
                                          <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentReportsList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending" rowspan="3">payment initiated date  </th>
                                          <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentReportsList" aria-label="payment transfered date: activate to sort column descending" aria-sort="ascending" rowspan="3">payment transfered date</th>
                                          <th scope="col" colspan="8">APB</th>
                                          <th scope="col" colspan="8">ACH</th>
                                          <th scope="col" colspan="8">Total</th>
                                       </tr>
                                          <th scope="col" colspan="4" class="card-lg-blue-text">count</th>
                                          <th scope="col" colspan="4" class="card-lg-orange-text">Amount</th>
                                        
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-blue-text">Beneficiaries</th>
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-blue-text">In-progress</th>
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-blue-text">Success</th>
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-blue-text">Failure</th>
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-orange-text">Beneficiaries</th>
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-orange-text">In-progress</th>
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-orange-text">Success</th>
                                        <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-orange-text">Failure</th>
                                    
                                    <th scope="col" tabindex="0" aria-controls="tblPaymentReportsList" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" aria-sort="ascending" class="card-lg-blue-text">Beneficiaries</th>
                                    </thead>
                                    <tbody></tbody>
                                 </table>
                              </div>
                           </div>
                <div class="tab-pane fade" id="payment-failure-summary-tab-pane" role="tabpanel" aria-labelledby="disabled-tab" tabindex="0">
                            <h5 class="card-title mt-3 mb-0"><i class="bi bi-check2-circle"></i>  Rejected Reason Code Wise Failure Summary </h5>
                                 <table class="table table-striped w-100 no-footer dataTable mt-3" id="tblPaymentFailedReasonReportsList" aria-describedby="tblPaymentFailedReasonReportsList_info">
                                        <tr>  
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="S.No: activate to sort column descending" aria-sort="ascending">S.No</th>
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment transfered date: activate to sort column descending" aria-sort="ascending">Reason</th>
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment transfered date: activate to sort column descending" aria-sort="ascending">Reason Code</th>
                                           
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment transfered date: activate to sort column descending" aria-sort="ascending">APB Beneficiaries Count</th>
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">APB Beneficiaries Amount</th>
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">ACH Beneficiaries Count</th>
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">ACH Beneficiaries Amount</th>
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">Total Beneficiaries Count</th>
                                           <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblPaymentFailedReasonReportsList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">Total Beneficiaries Amount</th>
                                        </tr>
                                     </thead>
                                    <tfoot id="tblPaymentFailedReasonReportsList_tfoot">
                                      <tr>
                                          <th id="footerColumn0"></th>
                                          <th id="footerColumn1"></th>
                                          <th id="footerColumn2">Total</th>
                                          <th id="footerColumn3"></th>
                                          <th id="footerColumn4"></th>
                                          <th id="footerColumn5"></th>
                                          <th id="footerColumn6"></th>
                                          <th id="footerColumn7"></th>
                                          <th id="footerColumn8"></th>
                                      </tr>
                                  </tfoot>
                <div class="tab-pane fade" id="payment-filewise-summary-tab-pane" role="tabpanel" aria-labelledby="disabled-tab" tabindex="0">
                        <h5 class="card-title mt-3 mb-0"><i class="bi bi-check2-circle"></i>  Transfer File wise Summary </h5>
                          <div class="table-responsive cus-grid">
                             <table class="table table-striped w-100 no-footer dataTable mt-3" id="tblFileWiseSummarList" aria-describedby="tblFileWiseSummarList_info">
                                <thead>
                                   <tr>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="S.No: activate to sort column descending" aria-sort="ascending">S.No</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="taluk: activate to sort column descending" aria-sort="ascending">File Name</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">Payment Type</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="taluk: activate to sort column descending" aria-sort="ascending">Approved Date</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment transfered date: activate to sort column descending" aria-sort="ascending">File Generated Date</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment transfered date: activate to sort column descending" aria-sort="ascending">Payment Date</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">Total</th>
                                      
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">Success</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">Failed</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">EMO</th>
                                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblFileWiseSummarList" aria-label="payment initiated date: activate to sort column descending" aria-sort="ascending">Status</th>
                                   </tr>
                                </thead>
                                <tbody>
                                </tbody>
                             </table>
                       </div>
        </div>
      </section>
    </main>
    <footer id="footer" class="footer">
      <div class="copyright">
        &copy; Copyright <strong><span>TNeGA</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        Designed & Developed by <a href="https:
    </footer>
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
    <div class="modal fade viewdatainfo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
        <div class="modal-content">
          <div class="modal-header py-2">
            <h1 class="modal-title fs-5" id="exampleModalLabel"><i class="bi bi-file-earmark-person"></i><span id="popup_head"></span></h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          <div class="modal-body py-2">
            <div class="row scheme-data mb-2">
              <div class="col-md-4">
                <label for="ddl_district" class="form-label fw-bold">Scheme</label>
                <label for="ddl_district" class="form-label"><span id="popup_scheme"></span></label>
                <label for="ddl_district" class="form-label fw-bold">Year</label>
                <label for="ddl_district" class="form-label"><span id="popup_year"></span></label>
                <label for="ddl_district" class="form-label fw-bold">Month</label>
                <label for="ddl_district" class="form-label"><span id="popup_month"></span></label>
                <label for="ddl_district" class="form-label fw-bold">Beneficiary Name</label>
                <label for="ddl_district" class="form-label"><span id="popup_beneficiary_name"></span></label>
                <label for="ddl_district" class="form-label fw-bold">Mobile No</label>
                <label for="ddl_district" class="form-label"><span id="popup_beneficiary_mobile"></span></label>
                <label for="ddl_district" class="form-label fw-bold">ACH / ABP</label>
                <label for="ddl_district" class="form-label"><span id="popup_account_type"></span></label>
                <label for="ddl_district" class="form-label fw-bold">Installment</label>
                <label for="ddl_district" class="form-label"><span id="popup_installment"></span> </label>
                <label for="ddl_district" class="form-label fw-bold">Amount</label>
                <label for="ddl_district" class="form-label"><span id="popup_amount"></span> </label>
                <label for="ddl_district" class="form-label fw-bold">Transcation Date </label>
                <label for="ddl_district" class="form-label"><span id="popup_transcation"></span></label>
            <div class="row mb-2 dashboard">
              <div class="row" id="check_activity"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
    </div>
    <div class="modal fade blulkapproveSummary" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <h1 class="modal-title fs-5" id="exampleModalLabel"><i class="bi bi-file-earmark-person"></i><span id="popup_head"></span> Beneficiary Bulk Approve Summary</h1>
              <div class="table-responsive">
                <table class="table mt-3 w-100" class="table table-striped w-100 no-footer dataTable mt-3" id="tblBulkApproveSummary" aria-describedby="tblBulkApproveSummary_info">
                  <thead>
                    <tr>
                      <th scope="col"  class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">S.No</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Scheme</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">District</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Taluk </th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Year Month</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="1" colspan="2" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">APB </th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="1" colspan="2" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">ACH </th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="1" colspan="2" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Total</th>
                    </tr>
                      
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Count</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Amount</th>                    
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="tblBulkApproveSummary" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Amount</th>
                    
                  </thead>
                  <tbody>
                  </tbody>
                </table>
            <button type="button" class="btn btn-success" onclick="allApprovalPermissionEnable()" data-bs-dismiss="modal">Approve</button>
    <div class="modal fade deduplicationValidateFunctionsList" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <h1 class="modal-title fs-5" id="exampleModalLabel"><i class="bi bi-file-earmark-person"></i><span id="popup_head"></span> Validation Status</h1>
            <button type="button" class="btn-close" id="deduplicationValidateFunctionsListClose" data-bs-dismiss="modal" aria-label="Close"></button>
                <table class="table mt-3 w-100" class="table table-striped w-100 no-footer dataTable mt-3" id="deduplicationValidateFunctionsList" aria-describedby="deduplicationValidateFunctionsList_info">
                      <th scope="col" class="sorting sorting_asc">Validation Type</th>
                      <th scope="col" class="sorting sorting_asc">Validation Status</th>
                      <td>
                        <h4 style="font-size: 1.2rem;font-weight: 600;">Aadhaar Validation</h4>
                        <span>
                          <ul>
                            <li>Blank validation</li>
                            <li>Aadhaar length validation</li>
                            <li>Validity based on <b>Verhoeff</b> algorithm</li>
                            <li>Duplicate Validation Within Received Payload(<i>Scheme +  Year Month of Payment + Installment Id + Aadhaar</i>)</li>
                          </ul>
                        </span>
                      </td>
                      <td class="function_1_td"> <span id="function_1"></span></td>
                        <h4  style="font-size: 1.2rem;font-weight: 600;">Bank account validation (<small>ACH Payment</small>)</h4>
                            <li>Account no blank validation, Account no numeric validation</li>
                            <li>IFSC code length validation(<i>11 Characters</i>)</li>
                            <li>IIN No validation (<i>6 Digits</i>), IIN No numeric validation</li>
                            <li>Duplicate Account Validation Within Received Payload(<i>Scheme +  Year Month of Payment + Installment Id + Account no</i>)</li>
                      <td class="function_2_td"><span id="function_2"></span></td>
                        <h4  style="font-size: 1.2rem;font-weight: 600;">Duplicate Beneficiaries (<small>Against Previous Payment</small>)</h4>
                            <li>Duplicate APB Benificaries (<i>Scheme + Year Month of Payment + Installment Id +Aadhaar + Payment status [In progress / Success]</i>)</li>
                            <li>Duplicate ACH Benificaries (<i>Scheme + Year Month of Payment + Installment Id + Account No + Payment status [In progress / Success]</i>)</li>
                      <td class="function_3_td"><span id="function_3"></span></td>
            <button type="button" class="btn btn-primary" onclick="viewSummary()" data-bs-dismiss="modal" id="deduplicationBtn">View Validation Summary</button>
            <button class="btn btn-success" type="button" id="transferToPaymetProcessBtn" onclick="showTranferPaymentProcess();">Transfer to Payment Process</button>
   
    <div class="modal fade deduplicationValidateSummary" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <h1 class="modal-title fs-5" id="exampleModalLabel"><i class="bi bi-file-earmark-person"></i><span id="popup_head"></span>Validation Summary</h1>
            <button type="button" class="btn-close" id="validateSummaryClose" data-bs-dismiss="modal" aria-label="Close"></button>
                <table class="table mt-3 w-100" class="table table-striped w-100 no-footer dataTable mt-3" id="deduplicationValidateSummary" aria-describedby="deduplicationValidateSummary_info">
                      <th scope="col"  class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">S.No</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Scheme Name</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Subscheme Name</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">District Name</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Taluk Name</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Year Month</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Total Count</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Valid Count</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Error Count</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Duplicate Benificiary</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Duplicate Aadhaar</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Duplicate Account</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Invalid Beneficiary Name</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Invalid IIN (or) IFSC</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Invalid Aadhaar</th>
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Invalid Account</th>
                     
                      <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="deduplicationValidateSummary" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Download</th>
            <button type="button" class="btn btn-success" onclick="transferToPending()" data-bs-dismiss="modal" id="transFerToValidBtn">Transfer valid beneficiaries for approval</button>
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
        
        <div class="modal fade transferPaymentProcess" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
              <div class="modal-content">
                <div class="modal-header py-2">
                  <h1 class="modal-title fs-5" id="exampleModalLabel"><i class="bi bi-file-earmark-person"></i><span id="popup_head"></span> Transfer to Payment Process</h1>
                  <button type="button" class="btn-close" id="transferPaymentProcessCloseOne" data-bs-dismiss="modal" aria-label="Close"></button>
                <div class="modal-body py-2">
                  <div class="row scheme-data mb-2">
                    <div class="table-responsive">
                      <table class="table mt-3 w-100" class="table table-striped w-100 no-footer dataTable mt-3" id="transferPaymentProcess" aria-describedby="transferPaymentProcess_info">
                        <thead>
                          <tr>
                            <th scope="col"  class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">S.No</th>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">District</th>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Taluk </th>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="2" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Transfer Payment Process Status</th>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="1" colspan="2" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">APB </th>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="1" colspan="2" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">ACH </th>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="1" colspan="2" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Total</th>
                          </tr>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Count</th>
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Amount</th>                    
                            <th scope="col" class="sorting sorting_asc" tabindex="0" aria-controls="transferPaymentProcess" rowspan="1" colspan="1" aria-label="S.No: activate to sort column descending" style="width: 37px;" aria-sort="ascending">Amount</th>
                        </thead>
                        <tbody>
                          
                        </tbody>
                      </table>
                  <div class="row mb-2 dashboard">
                <div class="modal-footer">
                  <button type="button" class="btn btn-success" onclick="TransferPaymentProcessInziated();" id="transferBtn">Transfer</button>
                  
    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script type="text/javascript" src="assets/vendor/jquery-validate/js/jquery.validate.min.js"></script>
    <script src="assets/vendor/datatable/jquery.dataTables.min.js"></script>
    <script src="assets/vendor/datatable/dataTables.bootstrap5.min.js"></script>
    <script type="text/javascript" src="assets/vendor/datatable/js/dataTables.js"></script>
    <script type="text/javascript" src="assets/vendor/datatable/js/dataTables.bootstrap4.js"></script>
    <script src="assets/vendor/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="assets/vendor/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
    <script src="assets/vendor/datatables-buttons/js/jszip.min.js"></script>
    <script src="assets/vendor/datatables-buttons/js/pdfmake.min.js"></script>
    <script src="assets/vendor/datatables-buttons/js/vfs_fonts.js"></script>
    <script src="assets/vendor/datatables-buttons/js/buttons.html5.min.js"></script>
    <script src="assets/vendor/datatables-buttons/js/buttons.print.min.js"></script>
    <script src="assets/vendor/datatables-buttons/js/buttons.colVis.min.js"></script>
    <script src="assets/vendor/sweetalert2/js/sweetalert.min.js"></script>
    <script src="assets/vendor/sweetalert2/js/sweetalert2.all.min.js"></script>
    <script src="assets/vendor/toggle/bootstrap-toggle.min.js"></script>
    <script src="assets/js/global.js"></script>
    <script src="assets/js/alpinejs_3_10_2.min.js" defer></script>
    <script src="assets/lang/reports.js"></script>
    <script src='https:
    <script src="assets/scripts/xlsx.full.min.js"></script>
    <script src="assets/js/base64tojson.js"></script>
    <script src="assets/js/crypto-js.js"></script>
    <script src="assets/js/aes.js"></script>
  
    <script type="text/javascript" src="assets/vendor/toastr/toastr.min.js"></script>
    <script src="assets/vendor/encryption/crypto-js.min.js"></script>
    <script src="assets/vendor/encryption/Encryption.js"></script>
 
<script type="text/javascript">
  var url = window.location.href;
  var page_url = url.split('/');
  var page = page_url[4];
  var userDataString = getCookie('payment_official');
  userDataString = JSON.parse(userDataString);
  $(document).ready(function () {
    $(document).on({
          ajaxStop: function () {
            $('#preloader').hide();
          }
        });
    $('.official').each(function (i, obj) {
      var href = obj.getAttribute("href");
      if (href == page) {
        obj.classList.add('active');
      } else {
        obj.classList.remove('active');
      }
    });
    var userDataString = getCookie('payment_official');
    if (!userDataString) {
      $('#preloader').show();
      window.location.href = "login.html";
    }
    userDataString = JSON.parse(userDataString);
    $('#official_username').text(userDataString['first_name']);
    $('#UserID').val(userDataString['user_id']);
    window.loginUser_id = userDataString['user_id'];
    reloID = userDataString['role_id'];
      roleBasedPageAllow(loginUser_id,reloID);
    getSchemeCategory();
    getDistricts();
    $('#ddl_sub_scheme').on('change',function(){
    $('#ddl_department').empty();
    $('#ddl_sub_department').empty();
    $('#ddl_department').append($('<option>', {value: "",text: "--ALL--"}));
    $('#ddl_sub_department').append($('<option>', {value: "",text: "--ALL--"}));
      $.ajax({
        url: APIURL +'schem_filter',
        type: "POST",
        headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
        data: {case: "get_department",scheme_code:$('#ddl_scheme_code').val(),scheme_name:$('#ddl_scheme_name').val(),sub_scheme_name:$('#ddl_sub_scheme').val(),user_id:loginUser_id},
        success: function(response) {
          $('#preloader').hide();
            var department_code = response.data[0];
            getDepartment(department_code.department);
        },
        error: function(xhr, status, error) {
            console.log("Error:", error);
        }
      });
    $('#ddl_district').on('change', function () {
      var district_code = $('#ddl_district').val();
      $('#ddl_taluk').empty();
      $('#ddl_taluk').append('<option value="">--ALL--</option>');
      getTaluk(district_code);
});
function getCookie(name) {
    const cookies = document.cookie.split(';');
    for (let i = 0; i < cookies.length; i++) {
      const cookie = cookies[i].trim();
      if (cookie.startsWith(name + '=')) {
        return cookie.substring(name.length + 1);
    return null;
  }
function getSchemeCategory(){
    $('#ddl_scheme_name').empty();
    $('#ddl_sub_scheme').empty();
    $('#ddl_scheme_name').append($('<option>', {value: "", text: "--All--"}));
    $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--All--"}));
    $('#ddl_department').append($('<option>', {value: "",text: "--All--"}));
    $('#ddl_sub_department').append($('<option>', {value: "",text: "--All--"}));
  $.ajax({
    url: APIURL +'schem_filter',
    type: "POST",
    headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
    data: {case: "get_scheme_category",get_column:"scheme_code",groupbycolumn:"scheme_code",user_id:loginUser_id},
    success: function(response) {
       
        var schemeCode = response.data;
        $('#ddl_scheme_cate').empty();
        $('#ddl_scheme_cate').append($('<option>', {
              value: "",
              text: "--All--"
          }));
        $.each(schemeCode, function (index, scheme) {
            if(schemeCode.length >1){
              $('#ddl_scheme_cate').append($('<option>', {
                value: scheme.scheme_category,
                text: scheme.scheme_category
            }));
            }else{
            }).prop('selected', true));
            $('#ddl_scheme_cate').trigger('change');
            }
         });
    },
    error: function(xhr, status, error) {
        console.log("Error:", error);
  });
}
$('#ddl_scheme_cate').on('change',function(){
  $('#filter_based_info_card_div').hide();
  $('#tblCard').hide();
  $('#payment_date_input').val('');
    $('#ddl_scheme_code').empty();
    $('#ddl_scheme_code').append($('<option>', {value: "", text: "--All--"}));
      let scheme_cate = $(this).val();
  if(scheme_cate ==''|| scheme_cate==null||scheme_cate==undefined){
    $('#ddl_year').empty();
    $('#ddl_payment_period').empty();
    $('#ddl_payment_installment').empty();
    $('#ddl_payment_cycle').text('Scheme Based Payment Period');
    $('#ddl_year').append($('<option>', {
          value: "",
          text: "Select Year - Month"
      }).attr('disabled','true').attr('selected', 'selected'));
      $('#ddl_payment_installment').append($('<option>', {
          text: "Select Installment"
      $('#ddl_payment_period').append($('<option>', {
          text: "Select the Payment Period"
   $.ajax({
     url: APIURL +'schem_filter',
     type: "POST",
     headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
     data: {case: "get_scheme_code",get_column:"scheme_code",groupbycolumn:"scheme_code",whereColumn:$('#ddl_scheme_cate').val(),user_id:loginUser_id},
     success: function(response) {
         var schemeCode = response.data;
         $('#ddl_scheme_code').empty();
         $('#ddl_scheme_code').append($('<option>', {
               value: "",
               text: "--All--"
           }));  
              $('#ddl_scheme_code').append($('<option>', {
                value: scheme.scheme_code,
                text: scheme.scheme_code
            $('#ddl_scheme_code').trigger('change');
     },
     error: function(xhr, status, error) {
         console.log("Error:", error);
     }
   });
})
$('#ddl_scheme_code').on('change',function(){
     $('#ddl_sub_scheme').empty();
     $('#ddl_scheme_name').empty();
     $('#ddl_department').empty();
     $('#ddl_sub_department').empty();
     $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--ALL--"}));
     $('#ddl_scheme_name').append($('<option>', {value: "", text: "--ALL--"}));
     $('#ddl_department').append($('<option>', {value: "",text: "--ALL--"}));
     $('#ddl_sub_department').append($('<option>', {value: "",text: "--ALL--"}));
   url: APIURL +'schem_filter',
   type: "POST",
   headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
   data: {case: "get_scheme",scheme_code:$('#ddl_scheme_code').val(),user_id:loginUser_id},
   success: function(response) {
    $('#preloader').hide();
       var schemeCode = response.data;
       $('#ddl_scheme_name').empty();
       $('#ddl_scheme_name').append($('<option>', {
             value: "",
             text: "--ALL--"
         }));
       $.each(schemeCode, function (index, scheme) {
        if(schemeCode.length >1){
          $('#ddl_scheme_name').append($('<option>', {
             value: scheme.scheme_name,
             text: scheme.scheme_name
        }else{
         }).prop('selected', true));
         $('#ddl_scheme_name').trigger('change');
         
       });
   },
   error: function(xhr, status, error) {
       console.log("Error:", error);
   }
 });
$('#ddl_scheme_name').on('change',function(){
   $('#ddl_sub_scheme').empty();
   $('#ddl_department').empty();
   $('#ddl_sub_department').empty();
   $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--ALL--"}));
   $('#ddl_department').append($('<option>', {value: "",text: "--ALL--"}));
   $('#ddl_sub_department').append($('<option>', {value: "",text: "--ALL--"}));
$('#preloader').show();
   data: {case: "get_sub_scheme",scheme_code:$('#ddl_scheme_code').val(),scheme_name:$('#ddl_scheme_name').val(),user_id:loginUser_id},
       $('#ddl_sub_scheme').empty();
       $('#ddl_sub_scheme').append($('<option>', {
        if(schemeCode.length > 1){
          $('#ddl_sub_scheme').append($('<option>', {
             value: scheme.subscheme_name,
             text: scheme.subscheme_name
        $('#ddl_sub_scheme').trigger('change');
function getDepartment(depID){
    $('#preloader').show();
$.ajax({
   url: APIURL +'get_department',
   data: {type: "department"},
       var department = response[0].data;
       $('#ddl_department').empty();
       $('#ddl_department').append($('<option>', {
       $.each(department, function (index, dep) {
         if(dep.department_code==depID){
           $('#ddl_department').append($('<option>', {
             value: dep.department_code,
             text: dep.department_name
           }).attr('selected', 'selected'));
           
           $.ajax({
                 url: APIURL +'schem_filter',
                 type: "POST",
                 headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
                 data: {case: "get_sub_department",scheme_code:$('#ddl_scheme_code').val(),scheme_name:$('#ddl_scheme_name').val(),sub_scheme_name:$('#ddl_sub_scheme').val(),department:$('#ddl_department').val(),user_id:loginUser_id},
                 success: function(response) {
                  $('#preloader').hide();
                     var subdepartment_code = response.data[0];
                     get_sub_department(dep.department_code,subdepartment_code.subdepartment);
                 },
                 error: function(xhr, status, error) {
                     console.log("Error:", error);
                 }
             });
         }
 function get_sub_department(depID,subDepID){
     $.ajax({
     url: APIURL +'get_department',
     data: {type: "sub_department",department_code:depID},
      $('#preloader').hide();
         var department = response[0].data;
         $('#ddl_sub_department').empty();
         $('#ddl_sub_department').append($('<option>', {
               text: "--ALL--"
           }));
         $.each(department, function (index, sub_dep) {
           if(sub_dep.sub_department_code==subDepID){
             $('#ddl_sub_department').append($('<option>', {
               value: sub_dep.sub_department_code,
               text: sub_dep.sub_department_name
           }
         get_schemebyuser(loginUser_id);
 }
  function getDistricts(){
    $('#ddl_district').selectpicker('destroy');
      const userDataString = getCookie("payment_official");
      const userData = JSON.parse(userDataString);
      var districtID=0;
      var data=[];
      if(userData['district_code']!=0){
      districtID=userData['district_code'];
      data={ case: 'district',district_code: districtID,user_id:userData['user_id']};
      data={ case: 'district',user_id:userData['user_id']};
    $.ajax({
      url: userMasterAPIURL+'userMaster',
      method: 'POST',
      headers: {'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
      data: data,
      dataType: 'json',
      success: function (response) {
        $('#preloader').hide();
        var district = response.district;
        var districtDropdown = $("#ddl_district");
        $('#ddl_district').empty();
        $('#ddl_district').append($('<option>', {value: "",text: "--ALL--"}));
        if(districtID==0 || districtID ==undefined){
        populateDropdown('ddl_district', response.districts, 'district');              
        } else {
        districtDropdown.html('<option value="'+district['district_code']+'">'+district['district_name']+'</option>');
        $('#ddl_district').trigger('change');
        var district_code= district['district_code'];
          getTaluk(district_code);
        } 
        $('#ddl_district').selectpicker();
      },
      error: function () {
        console.error('Error fetching district data');
  function getTaluk(districtID){
    $('#ddl_taluk').selectpicker('destroy');
    $('#ddl_taluk').empty();
    $('#ddl_taluk').append('<option value="">--ALL--</option>');
      var talukID=0;
      if(userData['taluk_code']!=0){
      talukID=userData['taluk_code'];
      data={ case: 'taluk',district_code: districtID,taluk_code: talukID,user_id:userData['user_id']};
      data={ case: 'taluk',district_code: districtID,user_id:userData['user_id']};
      url: userMasterAPIURL+'userMaster', 
      headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
        var taluk = response.taluk
        var talukDropdown = $("#ddl_taluk");
        if(talukID==0){
          populateDropdown('ddl_taluk', response.taluk, 'taluk');             
          talukDropdown.html('<option value="'+taluk['taluk_code']+'">'+taluk['taluk_name']+'</option>');
        $('#ddl_taluk').trigger('change');
        $('#ddl_taluk').selectpicker();
        Swal.fire({
          icon: "error",
          title: "Service Error!",
          showConfirmButton: false,
          timer: 2000
        })
  $('#paymentDate').on('change', function() {
    var todayDate = new Date(); 
    todayDate.setDate(todayDate.getDate() - 1);
    var toDate = new Date($(this).val());
    if (toDate < todayDate) {
        alert('To Date should be a future date.');
        $(this).val('');
    $('#paymentDate_error').hide();
  $('#reinitiatePaymentDate').on('change', function() {
    $('#reinitiatePaymentDate_error').hide();
$('#filter_based_info_card_div').hide();
$('#tblCard').hide();
var formsFilter = [];
window.localStorage.removeItem('filters');
$(document).ready(function() {
  $("#formFilters").validate({
          rules: {
            ddl_scheme_cate: {required: true},
            ddl_scheme_code: {required: true},
            ddl_scheme_name: {required: true},
            ddl_sub_scheme: {required: true},
            ddl_department: {required: true},
            ddl_sub_department: {required: true},
            ddl_year :{required: true},
            ddl_payment_period: {required: true},
            ddl_payment_installment : {required: true},
            ddl_year : {required: true},
          },
          messages: {
            ddl_scheme_cate: {required: "Select the Scheme Category"},
            ddl_scheme_code: {required: "Select the Scheme Code"},
            ddl_scheme_name: {required: "Select the scheme Name"},
            ddl_sub_scheme: {required: "Select the Sub Scheme Name"},
            ddl_department: {required: "Select the Deparment"},
            ddl_sub_department: {required: "Select the Sub Deparment"},
            ddl_year :{required: "Select the Year Month"},
            ddl_payment_period: {required: "Select the Payment Period"},
            ddl_payment_installment : {required: "Select the Installment"},
          errorClass: "help-inline text-danger",
          errorElement: "span",
          highlight: function(element, errorClass, validClass) {
              $(element).parents('.form-group').addClass('has-error');
          unhighlight: function(element, errorClass, validClass) {
              $(element).parents('.form-group').removeClass('has-error');
              $(element).parents('.form-group').addClass('has-success');
          submitHandler: function(form,e) {
              e.preventDefault();
              formsFilter.length = 0;
              formsFilter = [];
              var formData = $(form).serialize();
              window.localStorage.removeItem('filters');
              window.localStorage.setItem('filters', JSON.stringify(formData));
              $('#lable_text_scheme_cate').text($('#ddl_scheme_cate').val());
              $('#lable_text_scheme_code').text($('#ddl_scheme_code').val());
              $('#lable_text_scheme').text($('#ddl_scheme_name').val());
              $('#lable_text_sub_scheme').text($('#ddl_sub_scheme').val());
              $('#lable_text_Department').text($("#ddl_department option:selected").text());
              $('#lable_text_sub_department').text($("#ddl_sub_department option:selected").text());
              let paymentCycle = $('#ddl_payment_cycle').text();
              if($("#ddl_payment_period option:selected").val()!='' && $("#ddl_payment_period option:selected").val()!=null && $("#ddl_payment_period option:selected").val()!=undefined){
                paymentCycle = $('#ddl_payment_cycle').text()+'-'+$("#ddl_payment_period option:selected").text();
              }
              $('#lable_text_payment_period').text(paymentCycle);
              $('#lable_text_year_month').text($("#ddl_year option:selected").text());
              $('#lable_text_installment').text($("#ddl_payment_installment option:selected").text());
              if ($('#ddl_scheme_code').val() !== '' && $('#ddl_scheme_name').val() !== '' && $('#ddl_sub_scheme').val() !== '' && $('#ddl_department').val() !== '' && $('#ddl_sub_department').val() !== '') {
                if(($('#payment_date_input').val()=='' )|| ($('#payment_date_input').val() == null) || ($('#payment_date_input').val() == undefined)){
                  getpaymentDate();
                }
                  $('#filter_based_info_card_div').show();
                  $('#tblCard').show();
                  $('#accordionExample .accordion-collapse').collapse('hide');
                    var tabId = $('#approvelpayment').val();
                    if(tabId==''){tabId = 3;}
                    tabClickValue(tabId);
                    $('html, body').animate({
                    scrollTop: $("#tblCard").offset().top
                    }, 2000);
              }else{
                $('#filter_based_info_card_div').hide();
              return false;
window.getCurrentTabId = -1;
$('#tblPaymentReportsList_taluk').hide();
function tabClickValue(tabID){
  var dataFilters = window.localStorage.getItem('filters');
  var input_schemCode = $('#ddl_scheme_code').val();
  var input_schemName = $('#ddl_scheme_name').val();
  var input_subScheme = $('#ddl_sub_scheme').val();
  var input_dep = $('#ddl_department').val();
  var input_subDep = $('#ddl_sub_department').val();
  var input_dateMonthYear = $('#dayWeekMonthFilter').val();
let pamentbooleanSet =  $('#pamentbooleanSet').val();
  getCurrentTabId = tabID;
  if(tabID==0){
    $('#approvelpayment').val(0);
      if (input_schemCode !== '' && input_schemName !== '' && input_subScheme !== null && input_dep !== '' && input_subDep !== '' && input_dateMonthYear !== '') {
        get_pending_paymment_list(dataFilters,1);
        $('#profile-tab-pane').show();
      } else {$('#profile-tab-pane').hide();}  
  }else if(tabID==1){
    $('#approvelpayment').val(1);
        get_success_paymment_list(dataFilters,3);
        $('#payment-success-tab-pane').show();
      } else {$('#payment-success-tab-pane').hide();}
  else if(tabID==3){
    $('#approvelpayment').val(3);
        get_inprogress_paymment_list(dataFilters,2);
        $('#inprogress-tab-pane').show();
      } else {$('#inprogress-tab-pane').hide();}
  else if(tabID==4){
    $('#approvelpayment').val(4);
    if (input_schemCode !== '' && input_schemName !== '' && input_subScheme !== null && input_dep !== '' && input_subDep !== '' && input_dateMonthYear !== '') {
      get_generate_payment_file_pre_list(dataFilters,5);
        $('#payment-failed-tab-pane2').show();
      } else {$('#payment-failed-tab-pane2').hide();}   
  else if(tabID==5){
    $('#approvelpayment').val(5);
        get_transfer_payment_to_bank_pre_list(dataFilters,6);
        $('#payment-failed-tab-pane3').show();
      } else {$('#payment-failed-tab-pane3').hide();}
  }else if(tabID == 8){
    $('#tblPaymentReportsList_taluk').hide();
    $('#checkTaluk').prop('checked', false);
    $('#approvelpayment').val(8);
        if (input_schemCode !== '' && input_schemName !== '' && input_subScheme !== null && input_dep !== '' && input_subDep !== '' && input_dateMonthYear !== '') {
                get_payment_report_list(0);
            $('#inprogress-tab-pane').hide();
          $('#payment-report-summary-tab-pane').show();
        } else {$('#payment-report-summary-tab-pane').hide();}
  }else if(tabID == 9){
    $('#approvelpayment').val(9);
              get_reason_wise_summary_list();
            $('#payment-report-summary-tab-pane').hide();
          $('#payment-failure-summary-tab-pane').show();
        } else {$('#payment-failure-summary-tab-pane').hide();}
  }else if(tabID == 10){
    $('#approvelpayment').val(10);
              get_file_wise_reason_summary();
          $('#payment-filewise-summary-tab-pane').show();
        } else {$('#payment-filewise-summary-tab-pane').hide();}
$('#checkTaluk').on('change', function() {
          if ($(this).prop('checked')) {
          get_payment_report_list(1);
          } else {
          get_payment_report_list(0);
      }else{
        icon: "error",
        title: 'Please Select Schemes And Payment Period',
        showConfirmButton: false,
        timer: 2000
let tableRecordCount = 0;
function get_pending_paymment_list(dataFilters,approveStatus){
  $('#preloader').show();
    $('#tblPaymentPendingList').DataTable().clear().destroy();
    $('#tblPaymentPendingList').DataTable({
        "aLengthMenu": [10, 25, 50,100],
        "pageLength": 50,
        "footer": true,
        "dom": 'Bfrtip',
        "buttons": [
          {
                extend: 'csv',
                text: 'CSV',
                filename: 'Payment Lists',
                exportOptions: {
                    rows: ':visible', 
                    modifier: {
                        selected: null 
                    }
            },
            {
                extend: 'excel',
                text: 'Excel',
                filename: 'Payment Lists' 
                extend: 'pdf',
                text: 'PDF',
            }],
        "searching": true,
        "processing": true,
        "serverSide": true,
        "ajax": {
            "url": APIURL + 'payment_list_report',
            "type": "POST",
            "headers": { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
            "dataType": "JSON",
            "data": function (data) {
              data.fileters = dataFilters;
              data.approveStatus = approveStatus;
              data.user_id = loginUser_id;
          "beforeSend": function () {
            tblPreloaderEnable('tblPaymentPendingList');
          "error": function (xhr, error, thrown) {
                Swal.fire({
                    icon: "error",
                    title: 'Service Error !',
                    showConfirmButton: false,
                    timer: 2000
                });
            "dataSrc": 'data',
        "columns": [
            { "data": "checkbox" },
            { "data": "S.No", render: function (data, type, row, meta) {
                return meta.row + meta.settings._iDisplayStart + 1;
            { "data": "scheme_name" },
            { "data": "year_code" },
            { "data": "month_name" },
            { "data": "benificiary_name" },
            { "data": "benificiary_mobile_no"},
            { "data": "payment_mode_name"},
            { "data": "installment_id"},
            { "data": "amount"},
            { "data": "created_dt"},
            { "data": "action" },
        ],
        "aoColumnDefs": [{
          'bSortable': false,
          'aTargets': [0]
        }],
        "drawCallback": function (settings) {
        "initComplete": function (settings, json) {
         $('#preloader').hide(); 
         tableRecordCount = json.recordsTotal;
    });  
function get_inprogress_paymment_list(dataFilters,approveStatus){
    var optionValues = $('#label_payment_date').find('option').map(function() {
      if($(this).val()){
          return $(this).val();        
    }).get();
    $('#tblPaymentInprogressList').DataTable().clear().destroy();
    $('#tblPaymentInprogressList').DataTable({
        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
        "pageLength": 30, 
              data.paymentDateArr = optionValues;
            "beforeSend": function () {
            $('#preloader').show(); 
            tblPreloaderEnable('tblPaymentInprogressList');
            "error": function (xhr, error, thrown) {
        $('#preloader').hide(); 
        tableRecordCount = json.recordsTotal;
$('.failure_reason_lable').hide();
function get_failed_paymment_list(dataFilters,approveStatus,rejected_reason){
  $('.dataTables_filter').hide();
  $('#tblPaymentFailedList').DataTable().clear().destroy();
  $('#tblPaymentFailedList').DataTable({
      "pageLength": 30, 
      "footer": true,
      "dom": 'Bfrtip',
      "buttons": [
        {
              extend: 'csv',
              text: 'CSV',
              filename: 'Payment Lists',
              exportOptions: {
                  rows: ':visible', 
                  modifier: {
                      selected: null 
                  }
              extend: 'excel',
              text: 'Excel',
              filename: 'Payment Lists' 
              extend: 'pdf',
              text: 'PDF',
          }],
      "searching": true,
      "processing": true,
      "serverSide": true,
      "ajax": {
          "url": APIURL + 'payment_list_report',
          "type": "POST",
          "headers": { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
          "dataType": "JSON",
          "data": function (data) {
            data.fileters = dataFilters;
            data.approveStatus = approveStatus;
            data.user_id = loginUser_id;
            data.rejected_reason = rejected_reason;
              $('#preloader').show();
              $('#tblPaymentFailedList_wrapper > .dt-buttons').hide();
              $('#tblPaymentFailedList_filter.dataTables_filter').hide();
              $('.failure_reason_lable').hide();
              Swal.fire({
                  icon: "error",
                  title: 'Service Error !',
                  showConfirmButton: false,
                  timer: 2000
              });
          "dataSrc": 'data',
      "columns": [
          { "data": "checkbox" },
          { "data": "S.No", render: function (data, type, row, meta) {
              return meta.row + meta.settings._iDisplayStart + 1;
          { "data": "scheme_name" },
          { "data": "year_code" },
          { "data": "month_name" },
          { "data": "benificiary_name" },
          { "data": "benificiary_mobile_no"},
          { "data": "payment_mode_name"},
          { "data": "installment_id"},
          { "data": "amount"},
          { "data": "created_dt"},
          { "data": "rejection_reason"},
          { "data": "action" },
      ],
      "aoColumnDefs": [{
            'bSortable': false,
            'aTargets': [0]
      "drawCallback": function (settings) {
          $('#tblPaymentFailedList_filter.dataTables_filter').show();
          $('#tblPaymentFailedList_wrapper > .dt-buttons').show();
          $('.failure_reason_lable').show();
      "initComplete": function(settings, json) {
        $('#tblPaymentFailedList_filter.dataTables_filter').show();
        $('#tblPaymentFailedList_wrapper > .dt-buttons').show();
        $('.failure_reason_lable').show();
            $('#preloader').hide(); 
            tableRecordCount = json.recordsTotal;
            if (tableRecordCount != 0) {
                if (json.rejected_reson !== null) {
                      var selectFilterHtml = '<option value="">--All--</option>';
                      let selected;
                      $.each(json.rejected_reson, function(index, reason) {
                          if(rejected_reason == reason.rejection_reason_code){
                            selected = "selected";
                          }else{
                            selected = '';
                          }
                        selectFilterHtml += '<option value="' + reason.rejection_reason_code + '" '+selected+'>' + (reason.rejection_reason ? reason.rejection_reason: reason.rejection_reason_code) +'</option>';
                    });
                    $('#failur_reason_filter').html(selectFilterHtml);
              $('#failur_reason_filter').html('');
  });  
$('#failur_reason_filter').on('change',function(){
    let rejected_reason_value = $(this).val();
    get_failed_paymment_list(dataFilters,4,rejected_reason_value);
function get_success_paymment_list(dataFilters,approveStatus){
  $('#tblPaymentSuccessList').DataTable().clear().destroy();
  $('#tblPaymentSuccessList').DataTable({
           },
      "initComplete": function (settings, json) {
function get_generate_payment_file_pre_list(dataFilters,approveStatus){
$('#tblPaymentFilePreGenerateList').DataTable().clear().destroy();
$('#tblPaymentFilePreGenerateList').DataTable({
    "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
    "pageLength": 30, 
    "footer": true,
    "dom": 'Bfrtip',
    "buttons": [
      {
            extend: 'csv',
            text: 'CSV',
            filename: 'Payment Lists',
            exportOptions: {
                rows: ':visible', 
                modifier: {
                    selected: null 
            extend: 'excel',
            text: 'Excel',
            filename: 'Payment Lists' 
            extend: 'pdf',
            text: 'PDF',
    "searching": true,
    "processing": true,
    "serverSide": true,
    "ajax": {
        "url": APIURL + 'payment_list_report',
        "type": "POST",
        "headers": { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
        "dataType": "JSON",
        "data": function (data) {
          data.fileters = dataFilters;
          data.approveStatus = approveStatus;
          data.user_id = loginUser_id;
        "beforeSend": function () {
        "error": function (xhr, error, thrown) {
            Swal.fire({
                icon: "error",
                title: 'Service Error !',
                showConfirmButton: false,
                timer: 2000
            });
        "dataSrc": 'data',
    "columns": [
        { "data": "S.No", render: function (data, type, row, meta) {
            return meta.row + meta.settings._iDisplayStart + 1;
        { "data": "scheme_name" },
        { "data": "year_code" },
        { "data": "month_name" },
        { "data": "benificiary_name" },
        { "data": "benificiary_mobile_no"},
        { "data": "payment_mode_name"},
        { "data": "installment_id"},
        { "data": "amount"},
        { "data": "created_dt"},
        { "data": "action" },
    ],
    "aoColumnDefs": [{
      'bSortable': false,
      'aTargets': [0]
    }],
    "drawCallback": function (settings) {
    "initComplete": function (settings, json) {
}); 
function get_transfer_payment_to_bank_pre_list(dataFilters,approveStatus){
$('#tblPaymenTransferList').DataTable().clear().destroy();
$('#tblPaymenTransferList').DataTable({
        "url": APIURL + 'payment_transfer_to_bank_list',
        { "data": "payment_mode" },
        { "data": "benificiary_count" },
        { "data": "total_amount" },
        { "data": "file_created_date"},
        { "data": "file_name"},
});  
function get_payment_report_list(taluk_enable){
  let districtOrtalukWise;
  if(taluk_enable===1){
    $('#tblPaymentReportsList_taluk').show();
     districtOrtalukWise = [
            { "data": "district_name" },
            { "data": "taluk_name" },
            { "data": "received_dt"},
            { "data": "approved_dt"},
            { "data": "payment_date"},
            { "data": "apb_beificiaries_count"},
            { "data": "apb_inprogress_count"},
            { "data": "apb_success_count"},
            { "data": "apb_failure_count"},
            { "data": "apb_beificiaries_amount"},
            { "data": "apb_inprogress_amount"},
            { "data": "apb_success_amount"},
            { "data": "apb_failure_amount"},
            { "data": "ach_beificiaries_count"},
            { "data": "ach_inprogress_count"},
            { "data": "ach_success_count"},
            { "data": "ach_failure_count"},
            { "data": "ach_beificiaries_amount"},
            { "data": "ach_inprogress_amount"},
            { "data": "ach_success_amount"},
            { "data": "ach_failure_amount"},
            { "data": "total_beificiaries_count" },
            { "data": "total_inprogress_count" },
            { "data": "total_success_count" },
            { "data": "total_failure_count" },
            { "data": "total_beificiaries_amount" },
            { "data": "total_inprogress_amount" },
            { "data": "total_success_amount" },
            { "data": "total_failure_amount" },
        ]
  }else{
    districtOrtalukWise = [
            { "data": "district_name"},
    $('#tblPaymentReportsList').DataTable().clear().destroy();
    $('#tblPaymentReportsList').DataTable({
        "pageLength": -1,
              {
                    extend: 'csv',
                    text: 'CSV',
                    filename: 'Payment Lists',
                    exportOptions: {
                        rows: ':visible', 
                        modifier: {
                            selected: null 
                        }
                },
                {
                    extend: 'excel',
                    text: 'Excel',
                    filename: 'Payment Lists' 
            "url": APIURL + 'get_payment_report_list',
            data: {
              fileters:dataFilters,
              user_id:loginUser_id,
              taluk_enable:taluk_enable
            tblPreloaderEnable('tblPaymentReportsList');
        "columns": districtOrtalukWise,
                $('#preloader').hide();
                totalgetReportRecords = json.recordsTotal;
                $('#accordionExample .accordion-collapse').collapse('hide');
function get_reason_wise_summary_list(){
    var dataFilters = window.localStorage.getItem('filters');
    $('#tblPaymentFailedReasonReportsList').DataTable().clear().destroy();
    $('#tblPaymentFailedReasonReportsList').DataTable({
            "url": APIURL + 'get_reasonwise_failure_summary',
              user_id:loginUser_id
            tblPreloaderEnable('tblPaymentFailedReasonReportsList');
            { "data": "reason"},
            { "data": "reason_code"},
            { "data": "apb_beneficiaries_count" },
            { "data": "apb_beneficiaries_value"},
            { "data": "ach_beneficiaries_count"},
            { "data": "ach_beneficiaries_value"},
            { "data": "total_beneficiaries_count"},
            { "data": "total_beneficiaries_value"},
      "footerCallback": function (row, data, start, end, display) {
          var api = this.api();
          if(data.length !=0 && data.length != undefined){
            $('#tblPaymentFailedReasonReportsList_tfoot').show();
          }else{
           $('#tblPaymentFailedReasonReportsList_tfoot').hide();
          var columnsToSum = [3, 4, 5, 6, 7, 8];
          columnsToSum.forEach(function (columnIndex) {
              var sum = api.column(columnIndex, { page: 'current' }).data()
                  .reduce(function (a, b) {
                      var val = parseFloat(b);
                      return isNaN(val) ? a : a + val;
                  }, 0);
                  $('#footerColumn'+columnIndex).text(sum);
              $(api.column(columnIndex).footer()).html(sum);
          });
    }); 
function get_file_wise_reason_summary(){
    $('#tblFileWiseSummarList').DataTable().clear().destroy();
    $('#tblFileWiseSummarList').DataTable({
            "url": APIURL + 'get_file_wise_summary',
            tblPreloaderEnable('tblFileWiseSummarList');
            { "data": "file_name" },
            { "data": "payment_mode"},
            { "data": "approved_dt" },
            { "data": "file_submitted_date"},
            { "data": "total_count"},
            { "data": "success_count"},        
            { "data": "failure_count"},
            { "data": "emo_count"},
            { "data": function (data, type, row, meta) {
              let status = '';
              if(data.inprogress_count !=0){
                status = '<span class="badge bg-info">in-progress</span>';
              }else if(data.inprogress_count ==0){
                status = '<span class="badge bg-success">Completed</span>';
                return status;
            },     
function populateDropdown(dropdownId, data, fieldName) {
    const dropdown = document.getElementById(dropdownId);
    data.forEach(item => {
      const option = document.createElement('option');
      option.value = item[fieldName + '_code'];
      option.textContent = item[fieldName + '_name'];
      dropdown.appendChild(option);
  $('#selectAllCheckbox').on('change', function () {
      $('tbody :checkbox').prop('checked', $(this).prop('checked'));
  $('#selectAllCheckbox2').on('change', function () {
  $('#selectAllCheckbox3').on('change', function () {
  function selectApprove(){
      var paymentDate = $('#paymentDate').val();
        if(paymentDate == ''){
          $('#paymentDate_error').show();
          $('#paymentDate').addClass('text-danger');
          var scrollTarget = document.getElementById('paymentDateForm');
          scrollableContainer.scrollTop = scrollTarget.offsetTop;
          return false;
     userDataString = JSON.parse(userDataString);
    let userID = userDataString['user_id'];
    var checkboxValues = [];
    $('input[name="pending_check[]"]:checked').each(function () {
      checkboxValues.push($(this).val());
    if (checkboxValues.length === 0) {
      Swal.fire({
          title: "No checkboxes are checked!",
    } else {
        $('#preloader').show();
        $.ajax({
          url: APIURL+'selectApprove', 
          method: 'POST',
          headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
          data: {groupOfarray:checkboxValues,fileters:dataFilters,approveStatus:1,user_id:userID,paymentDate:paymentDate},
          dataType: 'json',
          success: function (response) {
            $('#paymentDate').val('');
            if(response.success == 1)
              $('#preloader').hide();
              output = response.data;
                icon: "success",
                title: response.message,
              get_pending_paymment_list(dataFilters,1);
            else if(response.success == 0)
              })
          error: function () {
              icon: "error",
              title: "Service Error!",
              showConfirmButton: false,
              timer: 2000
            })
  let intervalId;
  $('#pending_approval_processing').hide();
  $('#paymentDate_error').hide();
  $('#reinitiatePaymentDate_error').hide();
  $('#paymentDate').removeClass('text-danger');
let buklApproveSummary = [];
  function allApprove(){
  if(input_schemCode !='' && input_schemName !='' && input_subScheme !='' && input_dep !='' && input_subDep !='' && input_dateMonthYear != ''){
          var paymentDate = $('#paymentDate').val();
            if(paymentDate == ''){
              $('#paymentDate_error').show();
              $('#paymentDate').addClass('text-danger');
              var scrollTarget = document.getElementById('paymentDateForm');
              scrollableContainer.scrollTop = scrollTarget.offsetTop;
              $("#formFilters").submit();
              $('.blulkapproveSummary').modal({backdrop: 'static',keyboard: false}).modal('show');
              var dataFilters = window.localStorage.getItem('filters');
              var approveStatus = 1;
              $('#tblBulkApproveSummary').DataTable().clear().destroy();
              $('#tblBulkApproveSummary').DataTable({
              "aLengthMenu": [10, 25, 50,100],
              "pageLength": -1,
              "footer": true,
              "dom": 'Bfrtip',
              "buttons": [
                  extend: 'csv',
                  text: 'CSV',
                  filename: 'Payment Lists',
                  exportOptions: {
                      rows: ':visible', 
                      modifier: {
                          selected: null 
                      }
              },
                  extend: 'excel',
                  text: 'Excel',
                  filename: 'Payment Lists' 
                  extend: 'pdf',
                  text: 'PDF',
              }],
              "searching": true,
              "processing": true,
              "serverSide": true,
              "ajax": {
              "url": APIURL + 'fn_payment_getbulkapprovestatistic',
              "type": "POST",
              "headers": { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
              "dataType": "JSON",
              "data": function (data) {
                data.fileters = dataFilters;
                data.approveStatus = approveStatus;
                data.user_id = loginUser_id;
              "beforeSend": function () {
                $('#preloader').show(); 
                tblPreloaderEnable('tblBulkApproveSummary');
              "error": function (xhr, error, thrown) {
                  Swal.fire({
                      icon: "error",
                      title: 'Service Error !',
                      showConfirmButton: false,
                      timer: 2000
                  });
              "dataSrc": 'data',
              "columns": [
              { "data": "S.No", render: function (data, type, row, meta) {
                  return meta.row + meta.settings._iDisplayStart + 1;
              { "data": "scheme_name" },
              { "data": "distrinct_name" },
              { "data": "taluk_name" },
              { "data": "yyyymm"},
              { "data": "apb_benificiaries_count" },
              { "data": "apb_benificiaries_amount"},
              { "data": "ach_benificiaries_count"},
              { "data": "ach_benificiaries_amount"},
              { 
              "data": "Total count", 
              "render": function (data, type, row, meta) {
              var apbCount = row.apb_benificiaries_count || 0;
              var achCount = row.ach_benificiaries_count || 0;
              return apbCount + achCount;
              "data": "Total Amount", 
              var apbAmount = row.apb_benificiaries_amount || 0;
              var achAmount = row.ach_benificiaries_amount || 0;
              return parseInt(apbAmount) + parseInt(achAmount);
              ],
              "aoColumnDefs": [{
              'bSortable': false,
              'aTargets': [0]
              "drawCallback": function (settings) {
              "initComplete": function (settings, json) {
              $('#preloader').hide(); 
              buklApproveSummary = json.data;
              }); 
  else{
          title: "Select must scheme code, scheme name,Subscheme, department, sub department and payment period",
          showConfirmButton: true,
    $("#formFilters").submit();
    $("html, body").animate({ scrollTop: 0 }, 3000);
  } 
function allApprovalPermissionEnable(){
  var paymentDate = $('#paymentDate').val();
       userDataString = JSON.parse(userDataString);
      let userID = userDataString['user_id'];
      var dataFilters = window.localStorage.getItem('filters');
      const uniqueId = generateUniqueId();
      window.localStorage.setItem('bulkApprvelID', uniqueId);
            let totalSummaryCount = 0; 
            buklApproveSummary.forEach(totalSUmmary => {
            const sum = parseInt(totalSUmmary.ach_benificiaries_count) + parseInt(totalSUmmary.apb_benificiaries_count);
            totalSummaryCount += sum;
            let bulkApprveIDGroupup = [];
              buklApproveSummary.forEach((summaryParems, index) => {
                  const uniqueId = generateUniqueId();
                  bulkApprveIDGroupup.push(uniqueId);
                  setTimeout(() => {
                    $.ajax({
                        url: APIURL + 'allApprove',
                        method: 'POST',
                        headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
                        data: { fileters: dataFilters,summaryDistrictCode:summaryParems.district_code,summaryTalukCode:summaryParems.taluk_code, approveStatus: 1,user_id:userID,trackingId:uniqueId,paymentDate:paymentDate},
                        dataType: 'json',
                        async: true,
                  }, index * 200);
               window.localStorage.setItem('bulkApprvelID', bulkApprveIDGroupup);
               
                  icon: "success",
                  title: "Pending Payment Bulk Approve Initiated",
            setTimeout(function() {getCurrentBulkApprovalCount();}, 3000);
            window.localStorage.setItem('bulkApprvelstatustrigger',0);
let checkValue = window.localStorage.getItem('bulkApprvelstatustrigger');
intervalId = 1;
$('#progress_strat').hide();
$('#selectApprovalBtn').hide();
$('#bulkApprovalBtn').hide();
var showColletionData = true;
function getCurrentBulkApprovalCount() {
  $('#selectApproval').show();
    $('#bulkApproval').show();
    let getTriggerid = window.localStorage.getItem('bulkApprvelID');
  if(intervalId !== undefined){
    if (intervalId == 1) {
      $('#progress_strat').show();
    if(intervalId ==1){
      get_pending_paymment_list(dataFilters,1);
    $('#selectApproval').hide();
    $('#bulkApproval').hide();
    $('#selectApprovalBtn').show();
    $('#bulkApprovalBtn').show();
      url: APIURL + 'bulkApprovalStatus',
      data: { trackingId: getTriggerid },
        var output = response.data[0];
        if (output.status ==1 || output.status ==2 ||output.status ==0) {
          showColletionData = false;
          $('#progress_strat').hide();
          $('#pending_approval_processing').show();
          if(output.status ==1 ||output.status ==0){
            setTimeout(function() {getCurrentBulkApprovalCount();}, 5000);
          if (output.status == 2) {
            $('#pending_approval_processing').hide();
            $('#selectApproval').show();
            $('#bulkApproval').show();
            $('#selectApprovalBtn').hide();
            $('#bulkApprovalBtn').hide();
            window.localStorage.setItem('bulkApprvelstatustrigger', output.status);
            $('#pending_approval_processing_count').text(output.updated_count);
            $('#pending_approval_processing_total_count').text(output.total_count);
        intervalId++;
          console.log("Error:", error);
function reInitiateApprove(){
  var reinitiatePaymentDate = $('#reinitiatePaymentDate').val();
    if(reinitiatePaymentDate == ''){
        $('#reinitiatePaymentDate_error').show();
        $('#reinitiatePaymentDate').addClass('text-danger');
        var scrollTarget = document.getElementById('reinitiatePaymentDateForm');
        scrollableContainer.scrollTop = scrollTarget.offsetTop;
        return false;
    $('input[name="failed_check[]"]:checked').each(function () {
    checkboxValues.push($(this).val());
          url: APIURL+'reinitiateApprove', 
          data: {groupOfarray:checkboxValues,fileters:dataFilters,approveStatus:4,user_id:userID},
              get_failed_paymment_list(dataFilters,4,null);
  $('#generate_payment_status').hide();
  $('#generate_payment_disable_btn').hide();
function triggerScript(scriptName) {
  window.localStorage.setItem('generate_payment_enable', true);
      $('#generate_payment_real_btn').hide();
      $('#generate_payment_status').addClass('d-inline');
      $('#generate_payment_status').show();
      $('#generate_payment_disable_btn').show();
    url: APIURL + 'execute_script', 
    method: 'GET', 
    headers: {
        'X-APP-KEY': config.app_key,
        'X-APP-NAME': config.app_name
    data: {
      script: scriptName,
      fileters:dataFilters
    dataType: 'json',
    success: function (response) {
      $('#generate_payment_status').removeClass('d-inline');
      $('#generate_payment_status').hide();
      $('#generate_payment_disable_btn').hide();
      $('#generate_payment_real_btn').show();
      window.localStorage.setItem('generate_payment_enable', false);
        if (response.success == 1) {
            output = response.data;
                title: "Generated Payment File Completed Successfully",
            get_generate_payment_file_pre_list(dataFilters,5);
        } else if (response.success == 0) {
    error: function () {
            icon: "error",
            title: "Service Error!",
            showConfirmButton: false,
            timer: 2000
        get_generate_payment_file_pre_list(dataFilters,5);
          title: "select best scheme code, scheme name,Subscheme, department, sub department and payment period",
$('#transfer_payment_status').hide();
$('#transfer_payment_disable_btn').hide();
function triggerScript2(scriptName) {
  window.localStorage.setItem('transfer_payment_enable', true);
  $('#transfer_payment_status').addClass('d-inline');
  $('#transfer_payment_status').show();
  $('#transfer_payment_disable_btn').show();
  $('#transfer_payment_enable').hide();
      $('#transfer_payment_status').removeClass('d-inline');
      $('#transfer_payment_status').hide();
      $('#transfer_payment_disable_btn').hide();
      $('#transfer_payment_enable').show();
      get_transfer_payment_to_bank_pre_list(dataFilters,6);
      window.localStorage.setItem('transfer_payment_enable', false);
function viewScheme(listID){
    url: APIURL + 'viewpopupData', 
    method: 'POST', 
      list_id: listID
            output = response.data[0];
            timeLine = response.data.timeline;
            $('#popup_head').text(output.beneficiary_name);
            $('#popup_scheme').text(output.scheme_name);
            $('#popup_year').text(output.year_part);
            $('#popup_month').text(output.Month);
            $('#popup_beneficiary_name').text(output.beneficiary_name);
            $('#popup_beneficiary_mobile').text(output.beneficiary_mobile_no);
            $('#popup_account_type').text(output.payment_mode);
            $('#popup_installment').text(output.installment_id);
            $('#popup_amount').text(output.amount);
            $('#popup_transcation').text(output.created_ts);
              var activeColStart = `<div class="col-lg-6">`;
              var activeColEnd = `</div>`;
              var activeTitleOne = `<h5 class="card-title mb-2 px-2"><i class="bi bi-check2-circle"></i> Activity</h5>`;
              var activeTitletwo = `<h5 class="card-title mb-2 px-2"><i class="bi bi-check2-circle"></i> Re-Initiate Activity</h5>`;
              let timelineValue = '';
              timeLine.forEach((action, key) => {
                timelineValue += `<div class="activity-item d-flex">
                <div class="activite-label">${key + 1}</div>
                <i class="bi bi-circle-fill activity-badge text-success align-self-start"></i>
                <div class="activity-content">
                Transcation by <span class="text-danger">${action.action_by}</span>, <small>${action.action_ts}</small> <span class="badge text-bg-primary">${action.action_desc}</span>
                </div>`;
              var transcation = `${activeColStart}<div class="activity">${activeTitleOne}`+`${timelineValue}</div>${activeColEnd}`;
              $('#check_activity').html(transcation);
      })
function generateUniqueId() {
  const timestamp = new Date().getTime();
  return `${timestamp}`;
function tblPreloaderEnable(tableName){
      var processingDiv = document.getElementById(tableName+'_processing');
      var displayStatus = window.getComputedStyle(processingDiv).display;
      if (displayStatus === 'block') {
      $('#'+tableName+'_processing').html(`<div id="preloader"></div>`);
        $('#'+tableName+'_processing').text(`<div id="preloader"></div>`);
var generate_payment_enable = window.localStorage.getItem('generate_payment_enable');
var transfer_payment_enable = window.localStorage.getItem('transfer_payment_enable');
if(generate_payment_enable === 'true'){
  $('#generate_payment_real_btn').hide();
  $('#generate_payment_status').addClass('d-inline');
  $('#generate_payment_status').show();
  $('#generate_payment_disable_btn').show();
if(transfer_payment_enable === 'true'){
    $('#transfer_payment_status').addClass('d-inline');
    $('#transfer_payment_status').show();
    $('#transfer_payment_disable_btn').show();
    $('#transfer_payment_enable').hide();
function viewSummary(){
  $('#transFerToValidBtn').hide();
      window.localStorage.setItem('deDuplicatePopup',2);
      $('.deduplicationValidateSummary').modal({backdrop: 'static',keyboard: false}).modal('show');
      var approveStatus = 1;
      $('#deduplicationValidateSummary').DataTable().clear().destroy();
      $('#deduplicationValidateSummary').DataTable({
      "aLengthMenu": [10, 25, 50,100],
      "pageLength": -1,
          extend: 'csv',
          text: 'CSV',
          filename: 'Payment Lists',
          exportOptions: {
              rows: ':visible', 
              modifier: {
                  selected: null 
          extend: 'excel',
          text: 'Excel',
          filename: 'Payment Lists' 
          extend: 'pdf',
          text: 'PDF',
      }],
      "url": APIURL + 'fn_payment_validatebenificiaries',
      "type": "POST",
      "headers": { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
      "dataType": "JSON",
      "data": function (data) {
      data.fileters = dataFilters;
      data.approveStatus = approveStatus;
      data.user_id = loginUser_id;
      "beforeSend": function () {
      $('#preloader').show(); 
      tblPreloaderEnable('deduplicationValidateSummary');
      "error": function (xhr, error, thrown) {
          Swal.fire({
              title: 'Service Error !',
      "dataSrc": 'data',
      { "data": "S.No", render: function (data, type, row, meta) {
          return meta.row + meta.settings._iDisplayStart + 1;
      { "data": "scheme_name" },
      { "data": "subscheme_name" },
      { "data": "district_name" },
      { "data": "taluk_name"},
      { "data": "yyyymm" },
      { "data": "total_count"},
      { "data": function (data, type, row, meta) {
          return data.total_count - data.error_count;
      { "data": "error_count"},
      { "data": "duplicatebenificiary"},
      { "data": "duplicateaadhaar"},
      { "data": "duplicateaccount"},
      { "data": "invalidbeneficiaryname"},
      { "data": "invalidiinorifsc"},
      { "data": "invalidaadhaar"},
      { "data": "invalidaccount"},
          return '<a onclick="downloadFileDuplicates('+data.distirict_code+','+data.taluk_code+')" ><span class="btn btn-primary btn-sm"><i class="bi bi-download"></i> Download</span></span>';
      $('#transFerToValidBtn').show();
      buklApproveSummary = json.data;
        if(buklApproveSummary==null){
          TransferPermissionBtnDisable();
          $('.deduplicationValidateSummary').modal('hide');
var bulkTransferPaymentProcessSummary = [];
let transferPaymentProcessApproveStatus = window.localStorage.getItem('transferPaymentProcess');
if(transferPaymentProcessApproveStatus === null){
  window.localStorage.setItem('transferPaymentProcess', 'false');
function showTranferPaymentProcess(){
  $('#transferBtn').prop('disabled',false);
  let transferPaymentProcess = window.localStorage.getItem('transferPaymentProcess');
  $('#deduplicationValidateFunctionsListClose').click();
  $('validateSummaryClose').click();
  if(transferPaymentProcess == 'true'){
    $('.transferPaymentProcess').modal({backdrop: 'static',keyboard: false}).modal('show');
        var dataFilters = window.localStorage.getItem('filters');
        var approveStatus = 1;
        $('#transferPaymentProcess').DataTable().clear().destroy();
        $('#transferPaymentProcess').DataTable({
        "searching": false,
        "url": APIURL + 'transferPaymentSummaryList',
        data.fileters = dataFilters;
        data.approveStatus = approveStatus;
        data.user_id = loginUser_id;
        $('#preloader').show(); 
        tblPreloaderEnable('transferPaymentProcess');
        { "data": "district_name" },
        { "data": "taluk_name" },
        "data": "trackingID",
        "render": function (data, type, row) {
            return '<span id="'+data+'" ><span class="badge bg-warning btn-sm cursor-auto"><i class="bi bi-check2-circle"></i> Waiting For Confirmation</span></span>';
        { "data": "apb_count" },
        { "data": "apb_amount"},
        { "data": "ach_count"},
        { "data": "ach_amount"},
        { "data": "total_count"},
        { "data": "total_amount"},
        'bSortable': false,
        'aTargets': [0]
        var districtTalukArr = [];
            json.data.forEach(summary => {
                districtTalukArr.push({
                "district": summary.distirict_code,
                "taluk": summary.taluk_code,
                "trackingID" : summary.trackingID,
                "status" : 0
            bulkTransferPaymentProcessSummary = districtTalukArr;
            witchModalisActiveCheck();
function downloadFileDuplicates(district_code,taluk_code){
      url: APIURL + 'transferToPaymentProcessDownload',
      data: {fileters:dataFilters,district_code:district_code,taluk_code:taluk_code,user_id:loginUser_id},
        if(response.data!=null){
          exportJsonToExcel(response.data,'Duplicate Beneficiary');
          title: 'Summary is Empty !',
      error: function (xhr, status, error) {
function TransferPaymentProcessInziated(){
  bulkTransferPaymentProcessSummary.forEach(items => {
    if(items.status == 0){
      $('#'+items.trackingID).html(`<span class="badge bg-warning btn-sm cursor-auto"><i class="bi bi-check2-circle"></i> Yet to Transfer</span>`);
  if (bulkTransferPaymentProcessSummary.length > 0) {
      $('#transferBtn').prop('disabled',true);
      const batchSize = 5;
      var  trackingIDArr = bulkTransferPaymentProcessSummary.filter(n => n.status == 0);
      var runningprocess = bulkTransferPaymentProcessSummary.filter(n => n.status == 1);
      var loopcounter = batchSize;
      loopcounter = loopcounter - runningprocess.length;
      if (loopcounter > 0)
        if (loopcounter > trackingIDArr.length)
           loopcounter = trackingIDArr.length;
        processBatch(0,loopcounter,trackingIDArr);
  } else {
let failedTrackingIDs = [];
function processBatch(startIndex, loopcounter, trackingIDArr) {
  window.loginUser_id = userDataString['user_id'];
  let transferToPaymentUniqId = [];
    for (let i = startIndex; i < loopcounter; i++) {
      $.each( bulkTransferPaymentProcessSummary, function( j, obj ) {
            if(obj.trackingID == trackingIDArr[i].trackingID){              
              obj.status = 1;
        url: APIURL+'transferPaymentProcessbulkapproveNew',
        method: 'POST',
        data: {district:trackingIDArr[i].district, taluk:trackingIDArr[i].taluk, trackingID:trackingIDArr[i].trackingID, user_id:loginUser_id,fileters:dataFilters},
        dataType: 'json',
        success: function (response) {
          if(response.success == 0){
            let ouput = response.data;
            $('#' + ouput.trackingid).html('<span class="badge bg-danger btn-sm">Failed !</span>');
            $.each(bulkTransferPaymentProcessSummary, function( j, obj ) {
                if(obj.trackingID == ouput.trackingid){         
                  obj.status = 3;
        error: function (xhr, status, error) {
          updatestatus(trackingIDArr[i].trackingID);
function updatestatus(trakingId)
{
  $('#preloader').hide();
      data: { trackingId: trakingId },
        let output = response.data[0];
        if (output.status == 2) {
          $('#' + trakingId).html('<span class="badge bg-success btn-sm"><i class="bi bi-check2-circle"></i> Completed</span>');
          $.each( bulkTransferPaymentProcessSummary, function( j, obj ) {
            if(obj.trackingID == trakingId){         
              obj.status = 2;
          TransferPaymentProcessInziated();
          var failedTrackid = bulkTransferPaymentProcessSummary.filter(n => n.status == 3);
          if (failedTrackid.every(failedObj => failedObj.trackingID !== trakingId)) {
              $('#' + trakingId).html('<span class="badge bg-info btn-sm">' + output.updated_count + ' Updated</span>');
              setTimeout(() => { updatestatus(trakingId);}, 3000);
            TransferPaymentProcessInziated();
    const timestamp = new Date().getTime();
    return `${timestamp}`;
function exportJsonToExcel(jsonData, file_name) {
  var data = jsonData.map(obj => Object.values(obj));
  var ws = XLSX.utils.aoa_to_sheet([Object.keys(jsonData[0])].concat(data));
  var wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
  var binaryData = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'binary' });
  var blob = new Blob([s2ab(binaryData)], { type: 'application/octet-stream' });
  saveAs(blob, file_name + '.xlsx');
function s2ab(s) {
  var buf = new ArrayBuffer(s.length);
  var view = new Uint8Array(buf);
  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
  return buf;
function convertJsonToCsv(jsonData,filename) {
    let columns = Object.keys(jsonData[0]);
    let csvContent = [
        columns.join(','), 
        ...jsonData.map(obj => columns.map(col => obj[col]).join(',')) 
    ].join('\n');
    let blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    let link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.setAttribute('download', filename+'.csv');
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
let checkUploaderData = [];
function uploadDataList(dataFilters,approveStatus){
  $('#uploadDataList').DataTable().clear().destroy();
  $('#uploadDataList').DataTable({
              filename: 'Upload Summary List',
              filename: 'Upload Summary List' 
      "searching": false,
          "url": APIURL + 'uploadData_list',
          tblPreloaderEnable('uploadDataList');
          { "data": "district_name" },
          { "data": "taluk_name" },
          { "data": "yyyymm" },
          { "data": "apb_count"},
          { "data": "apb_amount"},
          { "data": "ach_count"},
          { "data": "ach_amount"},
          { "data": "total_count"},
          { "data": "total_amount" },
      $('#preloader').hide(); 
      checkUploaderData = json.data;
$('#deduplicationBtn').hide();
$('#transFerToValidBtn').hide();
  window.localStorage.setItem('deDuplicatePopup',0);
function paymentListActiveTab(){
  const currentDateAndTime = new Date();
  if(getCurrentTabId == 0){
    let fileName ='Pending_paymment_'+currentDateAndTime;
    downloadPaymentList(dataFilters,1,tableRecordCount,fileName);
  }else if(getCurrentTabId == 1){
    let fileName ='Success_paymment_'+currentDateAndTime;
      downloadPaymentList(dataFilters,3,tableRecordCount,fileName);
  }else if(getCurrentTabId == 2){
    let fileName ='Failed_paymment_'+currentDateAndTime;
      downloadPaymentList(dataFilters,4,tableRecordCount,fileName);
  }else if(getCurrentTabId == 3){
    let fileName ='Inprogress_paymment_'+currentDateAndTime;
      downloadPaymentList(dataFilters,2,tableRecordCount,fileName);
  else if(getCurrentTabId == 4){
    let fileName ='Generate_payment_'+currentDateAndTime;
      downloadPaymentList(dataFilters,5,tableRecordCount,fileName);
  else if(getCurrentTabId == 5){
    let fileName ='transfer_payment_to_bank_'+currentDateAndTime;
      downloadPaymentList(dataFilters,6,dataFilters);
function downloadPaymentList(dataFilters,approvalStatus,tableRecordCount,filename){
  if(dataFilters!='' || dataFilters!=null || dataFilters!= undefined){
    console.log('error function downloadPaymentList');
function _fnGetHeaders() {
    var dt = $('#uploadDataList').DataTable();
    var thRows = $('#uploadDataList thead tr');
    var numRows = thRows.length;
    var matrix = [];
    for (var rowIdx = 0; rowIdx < numRows; rowIdx++) {
        var $row = $(thRows[rowIdx]);
        var $ths = $row.find("th");
        var aRow = [];
        for (var colIdx = 0; colIdx < $ths.length; colIdx++) {
            var $th = $($ths.get(colIdx));
            aRow.push($th.text().trim());
        matrix.push(aRow);
    return matrix;
function htmlDecode(input) {
    var doc = new DOMParser().parseFromString(input, "text/html");
    return doc.documentElement.textContent;
function processDates(fromDateStr, toDateStr) {
    var fromDate = getYearMonth(fromDateStr);
    var toDate = getYearMonth(toDateStr);
    return {
        from: fromDate,
        to: toDate
    };
function get_schemebyuser(userid){
let ddl_scheme_cate = $('#ddl_scheme_cate').val();
let ddl_scheme_code = $('#ddl_scheme_code').val();
let ddl_scheme_name = $('#ddl_scheme_name').val();
let ddl_sub_scheme = $('#ddl_sub_scheme').val();
let ddl_department = $('#ddl_department').val();
let ddl_sub_department = $('#ddl_sub_department').val();
$('#ddl_payment_period').empty();
  $('#ddl_payment_cycle').text('');
  $('#payment_cycle_hidden').val('');
    url: APIURL +'get_scheme_by_user',
    data: {user_id:userid,ddl_scheme_cate:ddl_scheme_cate,ddl_scheme_code:ddl_scheme_code,ddl_scheme_name:ddl_scheme_name,ddl_sub_scheme:ddl_sub_scheme,ddl_department:ddl_department,ddl_sub_department:ddl_sub_department},
        if(response.success == 1){
      $('#ddl_payment_cycle').text(output.payment_cycle_text);
      $('#payment_cycle_hidden').val(output.payment_cycle);
      bindDropDownList(output.payment_cycle_text,'#ddl_payment_period');
        console.log("Error:", response);
$('#ddl_year').on('change',function(){
function bindDropDownList(type,element){
var userDataString = getCookie('payment_official');
userDataString = JSON.parse(userDataString);
window.loginUser_id = userDataString['user_id'];
        value: "",
        text: "Select Year - Month"
    }).attr('disabled','true').attr('selected', 'selected'));
    $('#ddl_payment_installment').append($('<option>', {
        text: "Select Installment"
    if (typeof type === 'object') {
      type = type[0];
    url: APIURL +'fn_general_getdropdownvalues',
    headers: {'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
    data: {user_id: loginUser_id,dropdown_type:type},
        var dropdownList = response.data;
        if(response.success ==1){
          $(element).show();
          $(element+'_col').show();
        $(element).empty();
        $(element).append($('<option>', {
              text: "Select "+type
        $.each(dropdownList, function (index, dep) {
          $(element).append($('<option>', {
              value: dep.id,
              text: dep.display_text
        if(element!=null && element!=''&&element!=undefined){
          $(element).hide();
          $(element+'_col').hide();
        if(type=='Monthly' || type=='Yearly'){
          get_instalment_filter();
$('#ddl_payment_period').on('change',function(){
  get_instalment_filter();
function get_instalment_filter(){
$('#ddl_payment_installment').empty();
$('#ddl_year').empty();
$('#ddl_year').append($('<option>', {
    value: "",
    text: "Select Year - Month"
}).attr('disabled','true').attr('selected', 'selected'));
let ddl_payment_period = $('#ddl_payment_period').val();
let ddl_payment_cycle = $('#payment_cycle_hidden').val();
if(ddl_payment_period=='' || ddl_payment_period==null||ddl_payment_period==undefined){
  ddl_payment_period = -1;
   url: APIURL +'get_installment_filter',
   data: {user_id:loginUser_id,ddl_scheme_cate:ddl_scheme_cate,ddl_scheme_code:ddl_scheme_code,ddl_scheme_name:ddl_scheme_name,ddl_sub_scheme:ddl_sub_scheme,ddl_department:ddl_department,ddl_sub_department:ddl_sub_department,paymentcycle:ddl_payment_cycle,paymentperiod:ddl_payment_period},
       if(response.success == 1){
        var output = response.data;
            let installment = fetchDropdownValues('Installment');
            installment.then(function(arrayValue) {
            let grounList = [];
            output.forEach(element => {
              grounList.push(element.installments);
            let instamentList = arrayValue.filter(item => grounList.includes(item.id));
            if(instamentList.length==1){
                  instamentList.forEach(list => {                 
                  $('#ddl_payment_installment').append($('<option>', {
                    value: list.value,
                    text: list.display_text
                  }).attr('selected','selected'));
                  $('#ddl_payment_installment').change();
                }else{
                  $('#ddl_payment_installment').append($('<option>', { value: "",text: "Select Installment"}));
                    instamentList.forEach(list => {                 
                    $('#ddl_payment_installment').append($('<option>', {
                      value: list.value,
                      text: list.display_text
                    }));
       }else{
       }
$('#ddl_payment_installment').on('change',function(){
  $('#ddl_year').selectpicker('destroy');
    let instalmment_value = $('#ddl_payment_installment').val();
  if(instalmment_value!='' || instalmment_value!=null){
      let installment_txt_value = $('#ddl_payment_installment option:selected').text();
      $('#installment_txt_value').val(installment_txt_value);
      let installment_txt_value = '';
let ddl_payment_installment = $('#ddl_payment_installment').val();
 url: APIURL +'get_year_filter',
 type: "POST",
 headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
 data: {user_id:loginUser_id,ddl_scheme_cate:ddl_scheme_cate,ddl_scheme_code:ddl_scheme_code,ddl_scheme_name:ddl_scheme_name,ddl_sub_scheme:ddl_sub_scheme,ddl_department:ddl_department,ddl_sub_department:ddl_sub_department,paymentcycle:ddl_payment_cycle,paymentperiod:ddl_payment_period,iinstallment:ddl_payment_installment},
 success: function(response) {
     if(response.success == 1){
      var output = response.data;
      $.each(output, function (index, list) {
            $('#ddl_year').append($('<option>', {
              value: list.yyyymm,
              text: list.yyyymm_text
      $('#ddl_year').selectpicker();
     }else{
      console.log("Error:", response);
 },
 error: function(xhr, status, error) {
     console.log("Error:", error);
async function dropDownList(type) {
try {
    const response = await $.ajax({
        url: APIURL + 'fn_general_getdropdownvalues',
        data: { user_id: loginUser_id, dropdown_type: type }
    return response.data;
} catch (error) {
    console.error("Error:", error);
    throw error;
async function fetchDropdownValues(type) {
    let getDropDown = await dropDownList(type);
    return getDropDown;
    console.error('Error occurred:', error);
$('#pamentbooleanSet').val(false);
function getpaymentDate(){
    $('#label_payment_date').empty();
            $('#label_payment_date').append($('<option>', {
            value: "",
            text: "--Payment Date Not Found--"
    userDataString = JSON.parse(userDataString)
    var loginUser_id = userDataString['user_id'];
      url: APIURL + 'get_payment_date', 
      method: 'POST', 
      headers: {
          'X-APP-KEY': config.app_key,
          'X-APP-NAME': config.app_name
      data: {
        fileters:dataFilters,
        user_id:loginUser_id
              let outputObject = [];
            $('#pamentbooleanSet').val(true);
              var payment_date = response.data;
              $('#label_payment_date').empty();
              $('#label_payment_date').append($('<option>', {
              }));
              $.each(payment_date, function (index, datelist) {
              if(payment_date.length >1){
                $('#label_payment_date').append($('<option>', {
                    value: datelist.payment_date,
                    text: datelist.payment_date
                }));
                  value: datelist.payment_date,
                  text: datelist.payment_date
                  }).prop('selected', true));
          } else if (response.success == 0) {
            $('#pamentbooleanSet').val(false);
                  icon: "question",
                  title: response.message,
                  timer: 4000
          if (response.success == 0) {
              setTimeout(() => {
                var tabId = $('#approvelpayment').val();
                if(tabId==''){tabId = 8;}
                tabClickValue(tabId);
              }, 4000);
            var tabId = $('#approvelpayment').val();
              if(tabId==''){tabId = 8;}
              tabClickValue(tabId);
  $('#label_payment_date').on('change',function(){
      let payment_date = $('#label_payment_date').val();
      $('#payment_date_input').val(payment_date);
      $('#formFilters').submit();
</script>
</body>
</html>