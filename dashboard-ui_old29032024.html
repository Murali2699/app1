
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Payment Automation Dashboard</title>
    <meta content="" name="description">
    <meta content="" name="keywords">
    <!-- Favicons -->
    <link href="assets/img/tn_logo.png" rel="icon">
    <link href="assets/img/tn_logo.png" rel="apple-touch-icon">
    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"> -->
    <link rel="stylesheet" href="assets/vendor/sweetalert2/css/sweetalert.min.css" />
    <link rel="stylesheet" href="assets/vendor/sweetalert2/css/sweetalert2.min.css" />
    <!-- <link rel="stylesheet" href="assets/vendor/toggle/bootstrap-toggle.min.css" /> -->
    <!-- CSS File --> 
    <link href="assets/css/style.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css"> -->
    <script src="assets/components/official_header.js" type="text/javascript" defer></script>
  </head>
  <body>
    <style>
      .show_column h3{
        font-size:1rem;
      }
      .accordion-item, .accordion-button:not(.collapsed) {
        border: none!important;
      }
      .customers-card-orange{
        border-left: 0.25rem solid #fe8402;
      }
      .customers-card-green-light{
        border-left: 0.25rem solid #6eba6e;
      }
      .customers-card-lavander{
        border-left: 0.25rem solid #8e63d0;
      }
      .customers-card-primary{
        border-left: 0.25rem solid #0d6efd;
      }
      .customers-card-red{
        border-left: 0.25rem solid #fd0d19;
      }
      span#received_on {
          position: absolute;
          right: 0;
          min-width: 200px;
      }
      .bg-blue{
        background-color: #2d5083;
      }
      .ml-2{
        margin-left: 3px;
      }
      #set_amount_convertion {
        color: #1a466a;
        font-weight: bolder;
        font-size: 1rem;
      }
      .font-custom-lable{
        font-size: 12px!important;
      }
      .font-custom-text{
        font-size: 12px!important;
        color:brown;
      }
      p#ddl_payment_cycle {
        border: 1px solid #d0d6dc;
        padding: 0.6rem;
        margin-top: rem;
        border-radius: 5px;
        font-size: 1rem;
      }

    </style>
    <!-- ======= Header & sidemenu ======= -->
    <official-header-component></official-header-component>
    <div id="preloader"></div>  
    <!-- End Sidebar-->
    <main id="main" class="main">
      <!-- Dashboard view starts -->
      <section>
        <div class="container-fluid">
          <div class="card mb-1">
            <form id="formFilters" method="post">
              <div class="card-body pb-0 pt-2">
                 <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                       <h2 class="accordion-header">
                          <button id="btnfilter" style="    background: linear-gradient(to right, rgb(44 43 88), rgb(34 25 111)) !important;
                             color: #fff !important;" class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                          <i class="bi bi-funnel"></i>  <span class="px-2">Apply Filter</span>
                          </button>
                       </h2>
                       <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                          <div class="accordion-body w-100">
                             <div class="row mb-2 boxflex">
                                <div class="col-md-3">
                                   <label for="ddl_scheme_cate" class="form-label fw-bold">Scheme category</label>
                                   <select class="form-select" id="ddl_scheme_cate" name="ddl_scheme_cate">
                                      <option value="">--select--</option>
                                   </select>
                                </div>
                                <div class="col-md-3">
                                   <label for="ddl_scheme_code" class="form-label fw-bold">Scheme Code</label>
                                   <select class="form-select" id="ddl_scheme_code" name="ddl_scheme_code"><option value="">--select--</option></select>
                                </div>
                                <div class="col-md-3">
                                   <label for="ddl_scheme_name" class="form-label fw-bold">Scheme Name</label>
                                   <select class="form-select" id="ddl_scheme_name" name="ddl_scheme_name">
                                      <option value="">--Select--</option>
                                   </select>
                                </div>
                                <div class="col-md-3">
                                   <label for="ddl_sub_scheme" class="form-label fw-bold">Sub Scheme Name</label>
                                   <select class="form-select" id="ddl_sub_scheme" name="ddl_sub_scheme">
                                      <option value="">--Select--</option>
                                   </select>
                                </div>
                                <div class="col-md-3">
                                   <label for="ddl_department" class="form-label fw-bold mt-3">Department</label>
                                   <select class="form-select" id="ddl_department" name="ddl_department">
                                      <option value="">--Select--</option>
                                   </select>
                                </div>
                                <div class="col-md-3">
                                   <label for="ddl_sub_department" class="form-label fw-bold mt-3">Sub Department</label>
                                   <select class="form-select" id="ddl_sub_department" name="ddl_sub_department">
                                      <option value="">--Select--</option>
                                   </select>
                                </div>
                             </div>
                             <hr>
                              <div class="row mb-2 boxflex">

                                <div class="col-md" id="ddl_payment_cycle_col">
                                  <label for="from_date" class="form-label fw-bold mt-3">Payment Cycle</label>

                                  <p id="ddl_payment_cycle">Scheme Based Payment Period</p>
                                </div>

                                <div class="col-md" id="ddl_payment_period_col">
                                  <label for="from_date" class="form-label fw-bold">Select Payment Period</label>
                                  <select name="ddl_payment_period" id="ddl_payment_period" class="form-select">
                                    <option value="" disabled selected>Select Payment Period</option>
                                  </select>
                                </div>

                                <div class="col-md" id="ddl_payment_installment_col">
                                  <label for="from_date" class="form-label fw-bold">Select Installment</label>
                                  <select name="ddl_payment_installment" id="ddl_payment_installment" class="form-select">
                                    <option value="" disabled selected>Select Installment</option>
                                  </select>
                                </div>

                                <div class="col-md" id="ddl_year_col">
                                  <label for="to_date" class="form-label fw-bold">Select Year - Month</label>
                                  <select name="ddl_year" id="ddl_year" class="form-select">
                                    <option value="" disabled selected>Select Year and month</option>
                                  </select>
                                </div>
                              </div>
                             <hr>
                            <div class="row mb-2 boxflex">
                              <div class="col-md-6">
                                <label for="ddl_district" class="form-label fw-bold">District</label>
                                <select class="form-select" id="ddl_district" name="ddl_district">
                                  <option value="">--select--</option>
                                </select>
                              </div>
                              <div class="col-md-6">
                                <label for="ddl_taluk" class="form-label fw-bold">Taluk</label>
                                <select class="form-select" id="ddl_taluk" name="ddl_taluk">
                                  <option value="">--select--</option>
                                </select>
                              </div>
                            </div>
                               
                            <div class="row mb-2 boxflex">
                              <button class="btn btn-success float-end cbtn col-md-2" type="submit"><i class="bi bi-pencil-square"></i> Submit</button>
                            </div>
                          </div>
                          <input type="hidden" name="approvelpayment" id="approvelpayment">
                       </div>
                    </div>
                 </div>
              </div>
              <input type="hidden" name="current_tab_value" id="current_tab_value" value="0">
              <input type="hidden" name="approvelpayment" id="approvelpayment">
              <input type="hidden" name="payment_date_input" id="payment_date_input">
              <input type="hidden" name="payment_cycle_hidden" id="payment_cycle_hidden">
              <input type="hidden" name="installment_txt_value" id="installment_txt_value">
              
           </form>
          </div>


          <!-- END: Dropdown card end here -->

          <div class="card mb-1 mt-2" id="filter_based_info_card_div">
            <div class="card-body pb-0 pt-2 bg-info-light">
              <div class="row">
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Scheme Category</label>
                  <p id="lable_text_scheme_cate" class="text-left font-custom-text"></p>
                </div>
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Scheme Code</label>
                  <p id="lable_text_scheme_code" class="text-left font-custom-text"></p>
                </div>
                
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Scheme Name</label>
                  <p id="lable_text_scheme" class="text-left font-custom-text"></p>
                </div>
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Sub Scheme Name</label>
                  <p id="lable_text_sub_scheme" class="text-left font-custom-text"></p>
                </div>
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Department</label>
                  <p id="lable_text_Department" class="text-left font-custom-text"></p>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Sub Department</label>
                  <p id="lable_text_sub_department" class="text-left font-custom-text"></p>
                </div>
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Payment Year-month</label>
                  <p id="lable_text_year_month" class="text-left font-custom-text"></p>
                </div>
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Payment Period</label>
                  <p id="lable_text_payment_period" class="text-left font-custom-text"></p>
                </div>
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">installment</label>
                  <p id="lable_text_installment" class="text-left font-custom-text"></p>
                </div>
                <div class="col">
                  <label class="form-label fw-bold font-custom-lable">Payment Date</label>
                  <select name="label_payment_date" id="label_payment_date" class="form-select text-center mb-2">
                    <option value="">--select--</option>
                  </select>
                </div>
              </div>                   
            </div>
          </div>
        <div id="scheme_wise_dashboard">
          <div class="card mb-2 mt-3">
            <div class="card-body">
              <div class="row mb-2">
                <h5 class="card-title pb- mb-0"><i class="bi bi-check2-circle"></i> Pre-validation Information
                </h5>
                
                <div class="col">
                  <div class="d-flex show_column">

                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-primary h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_data_received_count" class="fw-bold"></h3>
                          <span class="badge bg-primary"><i class="bi bi-card-checklist"></i>  Data Received </span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_processed_count" class="fw-bold"></h3>
                            <span class="badge bg-success"><i class="bi bi-card-checklist"></i>  Processed</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_no_proccessed_count" class="fw-bold"></h3>
                            <span class="badge bg-warning"><i class="bi bi-card-checklist"></i>  Yet to Processed</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-primary h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_valid_invalid_total_count" class="fw-bold"></h3>
                          <span class="badge bg-success"><i class="bi bi-card-checklist"></i> Processed</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_valid_count" class="fw-bold"></h3>
                            <span class="badge bg-blue"><i class="bi bi-card-checklist"></i>  Valid</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_invalid_count" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  In-valid</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-primary h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_pending_tranfered_total_count" class="fw-bold"></h3>
                          <span class="badge bg-blue"><i class="bi bi-card-checklist"></i> Valid</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_Transferred_count" class="fw-bold"></h3>
                            <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  Transferred</span>
                          </div>
                          <div class="col-md" >
                            <h3 id="card_pending_count" class="fw-bold"></h3>
                            <span class="badge bg-warning"><i class="bi bi-card-checklist"></i>  Pending</span>
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                </div>
              </div>

              <div class="row mb-2">
                <div class="col">
                  <div class="d-flex show_column">
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-megenta h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_invalid_count" class="fw-bold"></h3>
                          <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  In-valid</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_aadhar_invalid_count" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  Aadhar</span>
                          </div>
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_ac_invalid_count" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  Account</span>
                          </div>
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_iin_ifsc_invalid_count" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  IIN & IFSC</span>
                          </div>
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_in_valid_total_duplicate_count" class="fw-bold"></h3>
                            <span class="badge bg-danger"><i class="bi bi-card-checklist"></i>  Duplicate</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_obsolete_invalid_count" class="fw-bold"></h3>
                            <span class="badge" style="background:grey;"><i class="bi bi-card-checklist"></i> Obsolete</span>
                          </div>
                          
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-red h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_duplicate_count" class="fw-bold"></h3>
                          <span class="badge bg-danger"><i class="bi bi-card-checklist"></i>  Duplicate</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_aadhar_duplicate_count" class="fw-bold"></h3>
                            <span class="badge bg-danger"><i class="bi bi-card-checklist"></i>  Aadhar</span>
                          </div>
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_ac_duplicate_count" class="fw-bold"></h3>
                            <span class="badge bg-danger"><i class="bi bi-card-checklist"></i>  Account</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_duplicate_beneficiary_count" class="fw-bold"></h3>
                            <span class="badge bg-danger"><i class="bi bi-card-checklist"></i>  Payment</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>


            </div>
          </div>
          

          <div class="card mb-2 mt-3">
            <div class="card-body">
              <div class="row mb-2">
                <h5 class="card-title pb- mb-0"><i class="bi bi-check2-circle"></i> Distinct Beneficiary Information</h5>
                <div class="col">
                  <div class="d-flex show_column">
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-lavander h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_beneficiaries_total_count" class="fw-bold">0</h3>
                          <span class="badge text-bg-primary"><i class="bi bi-card-checklist"></i>  Total</span>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-orange h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_beneficiaries_inprogress_count" class="fw-bold">0</h3>
                          <span class="badge card-green-orange"><i class="bi bi-card-checklist"></i>  In-progress</span>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-green-light h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_beneficiaries_success_count" class="fw-bold">0</h3>
                          <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  Success</span>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-megenta h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_beneficiaries_failure_count" class="fw-bold">0</h3>
                          <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  Failure</span>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-primary h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_beneficiaries_emo_count" class="fw-bold">0</h3>
                          <span class="badge card-green-blue"><i class="bi bi-card-checklist"></i>  EMO</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          
          <div class="card mb-2 mt-3">
            <div class="card-body">
              <div class="row mb-2">
                <h5 class="card-title pb- mb-0"><i class="bi bi-check2-circle"></i> Transaction Count Information</h5>
                <div class="col">
                  <div class="d-flex show_column">
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-primary h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_count" class="fw-bold"></h3>
                          <span class="badge bg-primary"><i class="bi bi-card-checklist"></i>  Total </span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_total_abp_count" class="fw-bold"></h3>
                            <span class="badge bg-primary"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_total_ach_count" class="fw-bold"></h3>
                            <span class="badge bg-primary"><i class="bi bi-card-checklist"></i>  ACH</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-green h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_success_count" class="fw-bold"></h3>
                          <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  Success</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_abp_success_count" class="fw-bold"></h3>
                            <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_ach_success_count" class="fw-bold"></h3>
                            <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  ACH</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-orange h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_inprogress_count" class="fw-bold"></h3>
                          <span class="badge card-green-orange"><i class="bi bi-card-checklist"></i>  In-Progress</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_abp_inprogress_count" class="fw-bold"></h3>
                            <span class="badge card-green-orange"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_ach_inprogress_count" class="fw-bold"></h3>
                            <span class="badge card-green-orange"><i class="bi bi-card-checklist"></i>  ACH</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-megenta">
                        <div class="card-body pt-3">
                          <h3 id="card_total_failure_count" class="fw-bold"></h3>
                          <span class="badge card-green-megenta"> <i class="bi bi-people-fill"></i> Failure</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_abp_failure_count" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_ach_failure_count" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i> ACH</span> 
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card mb-2 mt-3">
            <div class="card-body">
              <div class="row mb-2">
                  <div class="col-md-8">
                    <h5 class="card-title pb- mb-0 d-flex align-items-baseline "><i class="bi bi-check2-circle" style="padding-right: 0.3rem;"></i> Transaction Amount Information (<span class="d-flex">
                      <label for="laksh" class="d-flex align-items-baseline"><input type="radio" name="changeLakshandCrore" onclick="changeLakshandCrore('laksh')" id="laksh" checked> <span class="card-title ml-2" style="color: #000;">Laksh</span> </label>

                      <label for="crore" class="d-flex align-items-baseline" style="margin-left: 1rem"><input type="radio" name="changeLakshandCrore" onclick="changeLakshandCrore('crore')" id="crore">  <span class="card-title ml-2" style="color: #000;">Crore</span></label>
                    </span>)
                    </div></h5>
                  </div>
                
                
                
                <div class="col">
                  <div class="d-flex show_column">
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-primary h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_amount" class="fw-bold"></h3>
                          <span class="badge bg-primary"><i class="bi bi-card-checklist"></i>  Total</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_total_abp_amount" class="fw-bold"></h3>
                            <span class="badge bg-primary"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_total_ach_amount" class="fw-bold"></h3>
                            <span class="badge bg-primary"><i class="bi bi-card-checklist"></i>  ACH</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-green h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_success_amount" class="fw-bold"></h3>
                          <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  Success</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_abp_success_amount" class="fw-bold"></h3>
                            <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_ach_success_amount" class="fw-bold"></h3>
                            <span class="badge card-green-text"><i class="bi bi-card-checklist"></i>  ACH</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-orange h-100">
                        <div class="card-body pt-3">
                          <h3 id="card_total_inprogress_amount" class="fw-bold"></h3>
                          <span class="badge card-green-orange"><i class="bi bi-card-checklist"></i>  In-Progress</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_abp_inprogress_amount" class="fw-bold"></h3>
                            <span class="badge card-green-orange"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_ach_inprogress_amount" class="fw-bold"></h3>
                            <span class="badge card-green-orange"><i class="bi bi-card-checklist"></i>  ACH</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col mx-2 text-center mb-2 align-items-stretch">
                      <div class="card info-card customers-card-megenta">
                        <div class="card-body pt-3">
                          <h3 id="card_total_failure_amount" class="fw-bold"></h3>
                          <span class="badge card-green-megenta"> <i class="bi bi-people-fill"></i> Failure</span>
                        </div>
                        <div class="row mb-3">
                          <div class="col-md" style="border-right: 2px solid #0d6efd !important;">
                            <h3 id="card_abp_failure_amount" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i>  APB</span>
                          </div>
                          <div class="col-md">
                            <h3 id="card_ach_failure_amount" class="fw-bold"></h3>
                            <span class="badge card-green-megenta"><i class="bi bi-card-checklist"></i> ACH</span> 
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          <div class="row mb-3">
            <div class="col-lg-6 mb-2">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title"><i class="bi bi-check2-circle"></i>  ACH/APB No of Count</h5>
              <div id="chart1"></div>
              </div>
            </div>
            </div>
            <div class="col-lg-6 mb-2">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title"><i class="bi bi-check2-circle"></i>  ACH/APB No of Amount</h5>
              <div id="chart2"></div>
              </div>
            </div>
            </div>
            </div>
          </div>

          <!-- END: list card end here -->
          <!-- START: modal popup -->
          <!-- Button trigger modal -->
        </div>

      </div>
      </section>
    </main>
    <!-- End #main -->
    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
      <div class="copyright">
        &copy; Copyright <strong><span>TNeGA</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        Designed & Developed by <a href="https://tngis.tn.gov.in/" target="_blank">TNeGA</a>
      </div>
    </footer>
    <!-- End Footer -->
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
    <!-- Delete modal starts -->
    <!-- view crop info ends -->
    <!-- Vendor JS Files -->
    
    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script type="text/javascript" src="assets/vendor/jquery-validate/js/jquery.validate.min.js"></script>
    
    <!-- Main JS File -->
    
    <script src="assets/js/global.js"></script>
    <script src="assets/js/base64tojson.js"></script>
    <script src="assets/js/crypto-js.js"></script>
    <script src="assets/js/aes.js"></script>
  

    <script type="text/javascript" src="assets/vendor/toastr/toastr.min.js"></script>
    
    <!-- Crypto js -->
    <script src="assets/vendor/encryption/crypto-js.min.js"></script>
    <!-- Encryption js -->
    <script src="assets/vendor/encryption/Encryption.js"></script>
    <script src="assets/vendor/sweetalert2/js/sweetalert2.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script type="text/javascript">
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    </script>
    
 
 <script type="text/javascript">
  var url = window.location.href;
  var page_url = url.split('/');
  var page = page_url[4];
  
  var userDataString = getCookie('payment_official');
  userDataString = JSON.parse(userDataString);
  $(document).ready(function () {
  
    $(document).on({
           ajaxStart: function () {
             $('#preloader').show();
            //  console.log('preloader is show');
           },
           ajaxStop: function () {
             $('#preloader').hide();
            //  console.log('preloader is show');
           }
         });
  
    $('.official').each(function (i, obj) {
      var href = obj.getAttribute("href");
      if (href == page) {
        obj.classList.add('active');
      } else {
        obj.classList.remove('active');
      }
    });
    // $('#preloader').hide();
    
    var userDataString = getCookie('payment_official');
    if (!userDataString) {
      $('#preloader').show();
      window.location.href = "login.html";
    }
  
    userDataString = JSON.parse(userDataString);
    $('#official_username').text(userDataString['first_name']);
    $('#UserID').val(userDataString['user_id']);
    window.loginUser_id = userDataString['user_id'];


    reloID = userDataString['role_id'];
    roleBasedPageAllow(loginUser_id,reloID);
    
    getSchemeCategory();
    // getSchemeCode();
    getDistricts();
  
    $('#ddl_sub_scheme').on('change',function(){      
     $('#ddl_department').empty();
     $('#ddl_sub_department').empty();
  
     $('#ddl_department').append($('<option>', {value: "",text: "--select--"}));
     $('#ddl_sub_department').append($('<option>', {value: "",text: "--select--"}));
  
       $.ajax({
         url: APIURL +'schem_filter',
         type: "POST",
         headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
         data: {case: "get_department",scheme_code:$('#ddl_scheme_code').val(),scheme_name:$('#ddl_scheme_name').val(),sub_scheme_name:$('#ddl_sub_scheme').val(),user_id:loginUser_id},
         success: function(response) {
            //  console.log("department:", response);
             var department_code = response.data[0];
            //  console.log(department_code.department);
             getDepartment(department_code.department);
         },
         error: function(xhr, status, error) {
             console.log("Error:", error);
         }
       });
    });
  
    $('#ddl_district').on('change', function () {
      var district_code = $('#ddl_district').val();
      $('#ddl_taluk').empty();
      $('#ddl_taluk').append('<option value="">--All--</option>');
      getTaluk(district_code);
    });

  });
  
  function getCookie(name) {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.startsWith(name + '=')) {
          return cookie.substring(name.length + 1);
        }
      }
      return null;
    }
  
  /* filters */

function getSchemeCategory(){
    
    $('#ddl_scheme_name').empty();
    $('#ddl_sub_scheme').empty();
    $('#ddl_department').empty();
    $('#ddl_sub_department').empty();
 
    $('#ddl_scheme_name').append($('<option>', {value: "", text: "--select--"}));
    $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--select--"}));
    $('#ddl_department').append($('<option>', {value: "",text: "--select--"}));
    $('#ddl_sub_department').append($('<option>', {value: "",text: "--select--"}));
 
  $.ajax({
    url: APIURL +'schem_filter',
    type: "POST",
    headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
    data: {case: "get_scheme_category",get_column:"scheme_code",groupbycolumn:"scheme_code",user_id:loginUser_id},
    success: function(response) {
       //  console.log("Success:", response);
        var schemeCode = response.data;
       //  console.log('scheme code >>> ',schemeCode);
 
        $('#ddl_scheme_cate').empty();
        $('#ddl_scheme_cate').append($('<option>', {
              value: "",
              text: "--select--"
          }));

        $.each(schemeCode, function (index, scheme) {
            // console.log('scheem code lenthg >>> ', schemeCode.length);
            if(schemeCode.length >1){
              $('#ddl_scheme_cate').append($('<option>', {
                value: scheme.scheme_category,
                text: scheme.scheme_category
            }));
            }else{
              $('#ddl_scheme_cate').append($('<option>', {
                value: scheme.scheme_category,
                text: scheme.scheme_category
            }).prop('selected', true));
            $('#ddl_scheme_cate').trigger('change');
            }
         });
    },
    error: function(xhr, status, error) {
        console.log("Error:", error);
    }
  });
}

let booleanSet = false;

$('#ddl_scheme_cate').on('change',function(){

  let scheme_cate = $(this).val();
  $('#filter_based_info_card_div').hide();
  $('#scheme_wise_dashboard').hide();
  labelPaymentMonthEmpty();
  

  if(scheme_cate ==''|| scheme_cate==null||scheme_cate==undefined){
    $('#ddl_year').empty();
    $('#ddl_payment_period').empty();
    $('#ddl_payment_installment').empty();
    $('#ddl_payment_cycle').text('Scheme Based Payment Period');
    
    $('#ddl_year').append($('<option>', {
          value: "",
          text: "Select Year - Month"
      }).attr('disabled','true').attr('selected', 'selected'));

      $('#ddl_payment_installment').append($('<option>', {
          value: "",
          text: "Select Installment"
      }).attr('disabled','true').attr('selected', 'selected'));

      $('#ddl_payment_period').append($('<option>', {
          value: "",
          text: "Select the Payment Period"
      }).attr('disabled','true').attr('selected', 'selected'));
      
  }

  $('#payment_date_input').val('');

    let select_scheme_cate = $(this).val();
      if(select_scheme_cate!='' && select_scheme_cate!=null){
        // alert('enable');
        booleanSet = true;
      }else{
        // alert('disable')
       booleanSet = false;
      }
  
    $('#ddl_scheme_code').empty();
    $('#ddl_scheme_name').empty();
    $('#ddl_sub_scheme').empty();
    $('#ddl_department').empty();
    $('#ddl_sub_department').empty();

    $('#ddl_scheme_code').append($('<option>', {value: "", text: "--select--"}));
    $('#ddl_scheme_name').append($('<option>', {value: "", text: "--select--"}));
    $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--select--"}));
    $('#ddl_department').append($('<option>', {value: "",text: "--select--"}));
    $('#ddl_sub_department').append($('<option>', {value: "",text: "--select--"}));
  
   $.ajax({
     url: APIURL +'schem_filter',
     type: "POST",
     headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
     data: {case: "get_scheme_code",get_column:"scheme_code",groupbycolumn:"scheme_code",whereColumn:$('#ddl_scheme_cate').val(),user_id:loginUser_id},
     success: function(response) {
        //  console.log("Success:", response);
         var schemeCode = response.data;
        //  console.log('scheme code >>> ',schemeCode);
  
         $('#ddl_scheme_code').empty();
         $('#ddl_scheme_code').append($('<option>', {
               value: "",
               text: "--select--"
           }));  

        $.each(schemeCode, function (index, scheme) {
            // console.log('scheem code lenthg >>> ', schemeCode.length);
            if(schemeCode.length >1){
              $('#ddl_scheme_code').append($('<option>', {
                value: scheme.scheme_code,
                text: scheme.scheme_code
            }));
            }else{
              $('#ddl_scheme_code').append($('<option>', {
                value: scheme.scheme_code,
                text: scheme.scheme_code
            }).prop('selected', true));
            $('#ddl_scheme_code').trigger('change');
            }
         });
     },
     error: function(xhr, status, error) {
         console.log("Error:", error);
     }
   });
})


  $('#ddl_scheme_code').on('change',function(){
    // $('#filter_based_info_card_div').hide();
    // $('#scheme_wise_dashboard').hide();
    // labelPaymentMonthEmpty();
  
       $('#ddl_sub_scheme').empty();
       $('#ddl_scheme_name').empty();
       $('#ddl_sub_scheme').empty();
       $('#ddl_department').empty();
       $('#ddl_sub_department').empty();
  
       $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--select--"}));
       $('#ddl_scheme_name').append($('<option>', {value: "", text: "--select--"}));
       $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--select--"}));
       $('#ddl_department').append($('<option>', {value: "",text: "--select--"}));
       $('#ddl_sub_department').append($('<option>', {value: "",text: "--select--"}));
  
  
     $.ajax({
     url: APIURL +'schem_filter',
     type: "POST",
     headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
     data: {case: "get_scheme",scheme_code:$('#ddl_scheme_code').val(),user_id:loginUser_id},
     success: function(response) {
        //  console.log("Success:", response);
         var schemeCode = response.data;
        //  console.log(schemeCode.scheme_code);
         $('#ddl_scheme_name').empty();
         $('#ddl_scheme_name').append($('<option>', {
               value: "",
               text: "--select--"
           }));
         // Iterate over the JSON object and append options
         $.each(schemeCode, function (index, scheme) {
          // console.log('scheem code lenthg >>> ', schemeCode.length);
          if(schemeCode.length >1){
            $('#ddl_scheme_name').append($('<option>', {
               value: scheme.scheme_name,
               text: scheme.scheme_name
           }));
          }else{
            $('#ddl_scheme_name').append($('<option>', {
               value: scheme.scheme_name,
               text: scheme.scheme_name
           }).prop('selected', true));
           $('#ddl_scheme_name').trigger('change');
          }
           
  
         });
     },
     error: function(xhr, status, error) {
         console.log("Error:", error);
     }
   });
  
  });
  
  $('#ddl_scheme_name').on('change',function(){
  
     
     // $('#ddl_scheme_name').empty();
     $('#ddl_sub_scheme').empty();
     $('#ddl_department').empty();
     $('#ddl_sub_department').empty();
  
     
     // $('#ddl_scheme_name').append($('<option>', {value: "", text: "--select--"}));
     $('#ddl_sub_scheme').append($('<option>', {value: "",text: "--select--"}));
     $('#ddl_department').append($('<option>', {value: "",text: "--select--"}));
     $('#ddl_sub_department').append($('<option>', {value: "",text: "--select--"}));
  
  
  
     $.ajax({
     url: APIURL +'schem_filter',
     type: "POST",
     headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
     data: {case: "get_sub_scheme",scheme_code:$('#ddl_scheme_code').val(),scheme_name:$('#ddl_scheme_name').val(),user_id:loginUser_id},
     success: function(response) {
        //  console.log("Success:", response);
         var schemeCode = response.data;
        //  console.log(schemeCode.scheme_code);
         $('#ddl_sub_scheme').empty();
         $('#ddl_sub_scheme').append($('<option>', {
               value: "",
               text: "--select--"
           }));
         // Iterate over the JSON object and append options
         $.each(schemeCode, function (index, scheme) {
          if(schemeCode.length > 1){
            $('#ddl_sub_scheme').append($('<option>', {
               value: scheme.subscheme_name,
               text: scheme.subscheme_name
           }));
          }else{
            $('#ddl_sub_scheme').append($('<option>', {
               value: scheme.subscheme_name,
               text: scheme.subscheme_name
           }).prop('selected', true));
          }
          $('#ddl_sub_scheme').trigger('change');
         });
     },
     error: function(xhr, status, error) {
         console.log("Error:", error);
     }
   });
  
  });
  
  // get_scheme
  
  
  /* filters */
  function getDepartment(depID){
     $('#ddl_department').empty();
     $('#ddl_sub_department').empty();
  
     $('#ddl_department').append($('<option>', {value: "",text: "--select--"}));
     $('#ddl_sub_department').append($('<option>', {value: "",text: "--select--"}));
       
  $.ajax({
     url: APIURL +'get_department',
     type: "POST",
     headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
     data: {type: "department"},
     success: function(response) {
         // console.log("Success:",JSON.parse(response)[0].data );
         var department = response[0].data;
         // Handle the successful response here
         $('#ddl_department').empty();
         $('#ddl_department').append($('<option>', {
               value: "",
               text: "--select--"
           }));
         // Iterate over the JSON object and append options
         $.each(department, function (index, dep) {
           if(dep.department_code==depID){
             $('#ddl_department').append($('<option>', {
               value: dep.department_code,
               text: dep.department_name
             }).attr('selected', 'selected'));
             // $('#ddl_department').trigger('change');
  
             $.ajax({
                   url: APIURL +'schem_filter',
                   type: "POST",
                   headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
                   data: {case: "get_sub_department",scheme_code:$('#ddl_scheme_code').val(),scheme_name:$('#ddl_scheme_name').val(),sub_scheme_name:$('#ddl_sub_scheme').val(),department:$('#ddl_department').val(),user_id:loginUser_id},
                   success: function(response) {
                      //  console.log("department:", response);
                       var subdepartment_code = response.data[0];
                      //  console.log(subdepartment_code.department);
                       get_sub_department(dep.department_code,subdepartment_code.subdepartment);
                   },
                   error: function(xhr, status, error) {
                       console.log("Error:", error);
                   }
               });
             
           }
         });
     },
     error: function(xhr, status, error) {
         console.log("Error:", error);
         // Handle the error here
     }
   });
  }
  
  
  // $('#ddl_department').on('change',function(){
   function get_sub_department(depID,subDepID){
     $('#ddl_sub_department').empty();
     $('#ddl_sub_department').append($('<option>', {value: "",text: "--select--"}));
  
       // var department = $('#ddl_department').val();
       $.ajax({
       url: APIURL +'get_department',
       type: "POST",
       headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
       data: {type: "sub_department",department_code:depID},
       success: function(response) {

           var department = response[0].data;
           // Handle the successful response here
           $('#ddl_sub_department').empty();
           $('#ddl_sub_department').append($('<option>', {
                 value: "",
                 text: "--select--"
             }));

           $.each(department, function (index, sub_dep) {
             if(sub_dep.sub_department_code==subDepID){
               $('#ddl_sub_department').append($('<option>', {
                 value: sub_dep.sub_department_code,
                 text: sub_dep.sub_department_name
             }).attr('selected', 'selected'));
             }
           });
           get_schemebyuser(loginUser_id);
       },
       error: function(xhr, status, error) {
           console.log("Error:", error);
           // Handle the error here
       }
     });

   }
  
    function getDistricts(){
        const userDataString = getCookie("payment_official");
        const userData = JSON.parse(userDataString);
  
        var districtID=0;
        var data=[];
        if(userData['district_code']!=0){
        districtID=userData['district_code'];
        data={ case: 'district',district_code: districtID,user_id:userData['user_id']};
        } else {
        data={ case: 'district',user_id:userData['user_id']};
        }
  
        $('#ddl_taluk').empty();
        $('#ddl_taluk').append('<option value="">--All--</option>');
      
      $.ajax({
        url: userMasterAPIURL+'userMaster',
        method: 'POST',
        headers: {'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
        data: data,
        dataType: 'json',
        success: function (response) {
          //console.log(response);
          var district = response.district;
          var districtDropdown = $("#ddl_district");
          $('#ddl_district').empty();
          $('#ddl_district').append($('<option>', {value: "",text: "--All--"}));
            
          if(districtID==0 || districtID ==undefined){
          populateDropdown('ddl_district', response.districts, 'district');              
          } else {
          districtDropdown.html('<option value="'+district['district_code']+'">'+district['district_name']+'</option>');
          $('#ddl_district').trigger('change');
          var district_code= district['district_code'];
            getTaluk(district_code);
          } 
        },
        error: function () {
          console.error('Error fetching district data');
        }
      });
    }
  
  
    
  
    /*START : Get Taluk list*/
    function getTaluk(districtID){
      $('#ddl_taluk').empty();
      $('#ddl_taluk').append('<option value="">--select--</option>');
      // var district=$("#ddl_district").val();
        const userDataString = getCookie("payment_official");
        const userData = JSON.parse(userDataString);
  
        // var district=district_code;
        var talukID=0;
        var data=[];
        if(userData['taluk_code']!=0){
        // districtID=userData['district_code'];
        talukID=userData['taluk_code'];
        data={ case: 'taluk',district_code: districtID,taluk_code: talukID,user_id:userData['user_id']};
        } else {
        data={ case: 'taluk',district_code: districtID,user_id:userData['user_id']};
        }
      
      
      $.ajax({
        url: userMasterAPIURL+'userMaster', // Replace with your API endpoint
        method: 'POST',
        headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
        data: data,
        dataType: 'json',
        success: function (response) {
          var taluk = response.taluk
          var talukDropdown = $("#ddl_taluk");
        //  populateDropdown('ddl_taluk', response.taluk, 'taluk'); 
          if(talukID==0){
            populateDropdown('ddl_taluk', response.taluk, 'taluk');             
          } else {
            
            talukDropdown.html('<option value="'+taluk['taluk_code']+'">'+taluk['taluk_name']+'</option>');
          $('#ddl_taluk').trigger('change');
          }
  
        },
        error: function () {
          Swal.fire({
            icon: "error",
            title: "Service Error!",
            showConfirmButton: false,
            timer: 2000
          })
        }
      });
    }
  
  
  
    /*END : Get Taluk list*/
  // });
  var formsFilter = [];
  window.localStorage.removeItem('filters');
  /*from submit*/
  $(document).ready(function() {
    


    $("#formFilters").validate({
            rules: {
              ddl_scheme_cate: {required: true},
              ddl_scheme_code: {required: true},
              ddl_scheme_name: {required: true},
              ddl_sub_scheme: {required: true},
              ddl_department: {required: true},
              ddl_sub_department: {required: true},
              ddl_payment_period: {required: true},
              ddl_payment_installment : {required: true},
              ddl_year : {required: true},
            },
            messages: {
              ddl_scheme_cate: {required: "Select the Scheme Category"},
              ddl_scheme_code: {required: "Select the Scheme Code"},
              ddl_scheme_name: {required: "Select the scheme Name"},
              ddl_sub_scheme: {required: "Select the Sub Scheme Name"},
              ddl_department: {required: "Select the Deparment"},
              ddl_sub_department: {required: "Select the Sub Deparment"},
              ddl_payment_period :{required: "Select the Payment Period"},
              ddl_payment_installment : {required: "Select the Installment"},
              ddl_year : {required: "Select the Year-Month"},
            },
            errorClass: "help-inline text-danger",
            errorElement: "span",
            highlight: function(element, errorClass, validClass) {
                $(element).parents('.form-group').addClass('has-error');
            },
            unhighlight: function(element, errorClass, validClass) {
                $(element).parents('.form-group').removeClass('has-error');
                $(element).parents('.form-group').addClass('has-success');
            },
            submitHandler: function(form,e) {
                e.preventDefault();
              
                formsFilter.length = 0;
                formsFilter = [];
                var formData = $(form).serialize();
                window.localStorage.removeItem('filters');
                window.localStorage.setItem('filters', JSON.stringify(formData));
                getDashboard('laksh');
                getDashboardDistinctBeneficiary();
                getDashboardBeneficiarySummary();
               
                $('#lable_text_scheme_cate').text($('#ddl_scheme_cate').val());
                $('#lable_text_scheme_code').text($('#ddl_scheme_code').val());
                $('#lable_text_scheme').text($('#ddl_scheme_name').val());
                $('#lable_text_sub_scheme').text($('#ddl_sub_scheme').val());
                $('#lable_text_Department').text($("#ddl_department option:selected").text());
                $('#lable_text_sub_department').text($("#ddl_sub_department option:selected").text());
              
              
              let paymentCycle = $('#ddl_payment_cycle').text();
              if($("#ddl_payment_period option:selected").val()!='' && $("#ddl_payment_period option:selected").val()!=null && $("#ddl_payment_period option:selected").val()!=undefined){
                paymentCycle = $('#ddl_payment_cycle').text()+'-'+$("#ddl_payment_period option:selected").text();
              }

              $('#lable_text_payment_period').text(paymentCycle);
              
              $('#lable_text_year_month').text($("#ddl_year option:selected").text());
              $('#lable_text_installment').text($("#ddl_payment_installment option:selected").text());
              // $('#lable_text_month').text(mm);
              

              if ($('#ddl_scheme_code').val() !== '' && $('#ddl_scheme_name').val() !== '' && $('#ddl_sub_scheme').val() !== '' && $('#ddl_department').val() !== '' && $('#ddl_sub_department').val() !== '') {
                if(($('#payment_date_input').val()=='' )|| ($('#payment_date_input').val() == null) || ($('#payment_date_input').val() == undefined)){
                  $('#scheme_wise_dashboard').hide();
                  getpaymentDate();
                }
                  $('#filter_based_info_card_div').show();
                  // $('#btnfilter').click();
                  $('#accordionExample .accordion-collapse').collapse('hide');
              }else{
                $('#filter_based_info_card_div').hide();
              } 
          
                return false;

            }
            
      });

            
  });

  
  
  
  function populateDropdown(dropdownId, data, fieldName) {
      const dropdown = document.getElementById(dropdownId);
  
      // Populate options from data
      data.forEach(item => {
        const option = document.createElement('option');
        option.value = item[fieldName + '_code'];
        option.textContent = item[fieldName + '_name'];
        dropdown.appendChild(option);
      });
    }
  
  
  function getDashboard(convertAmout){
    var userDataString = getCookie('payment_official');
    userDataString = JSON.parse(userDataString)
    var loginUser_id = userDataString['user_id'];

    var dataFilters = window.localStorage.getItem('filters');
    $.ajax({
      url: APIURL + 'getdashboard', // Replace with your API endpoint
      method: 'POST', // Change the method to GET
      headers: {
          'X-APP-KEY': config.app_key,
          'X-APP-NAME': config.app_name
      },
      data: {
        fileters:dataFilters,
        user_id:loginUser_id
      },
      dataType: 'json',
      success: function (response) {
              let outputObject = [];
              if (response.success == 1) {
              response.data.forEach((item) => {
                for (const key in item) {
                  if (item.hasOwnProperty(key)) {
                    outputObject[key] = Number(item[key]);
                  }
                }
              });
              output = outputObject;
      let card_no_of_file_processed =  output.ach_files_processed+output.apb_files_processed;
      let card_no_of_records = output.apb_total_beneficiaries_count+output.ach_total_beneficiaries_count;
      let card_no_of_banks = output.ach_banks_count+output.apb_banks_count;
      let card_total_success_count = output.ach_success_beneficiaries_count+output.apb_success_beneficiaries_count;
      let card_abp_success_count= output.apb_success_beneficiaries_count;
      let card_ach_success_count = output.ach_success_beneficiaries_count;

      let card_total_inprogress_count = output.apb_inprogress_count+output.ach_inprogress_beneficiaries_count
      let card_total_failure_count=output.ach_failure_beneficiaries_count+output.apb_failure_beneficiaries_count;

      let card_total_success_amount = (parseFloat(output.ach_success_value)+parseFloat(output.apb_success_value)).toFixed(4);

      let card_total_inprogress_amount = (parseFloat(output.ach_inprogress_value)+parseFloat(output.apb_inprogress_beneficiaries_value)).toFixed(4);

      let card_total_failure_amount = (parseFloat(output.ach_failure_value)+parseFloat(output.apb_failure_value)).toFixed(4);
      
      /*--------total card count-----------*/
      let total_count = parseInt(output.ach_failure_beneficiaries_count)+parseInt(output.ach_inprogress_beneficiaries_count)+parseInt(output.ach_success_beneficiaries_count)+parseInt(output.apb_failure_beneficiaries_count)+parseInt(output.apb_inprogress_count)+parseInt(output.apb_success_beneficiaries_count);
      let total_apb_count = parseInt(output.ach_failure_beneficiaries_count)+parseInt(output.ach_inprogress_beneficiaries_count)+parseInt(output.ach_success_beneficiaries_count);

      let total_ach_count = parseInt(output.apb_failure_beneficiaries_count)+parseInt(output.apb_inprogress_count)+parseInt(output.apb_success_beneficiaries_count);
      /*----------total card count---------*/


      /*---------total card Amount----------*/
      let total_apb_amount =  (parseFloat(output.apb_failure_value)+parseFloat(output.apb_inprogress_beneficiaries_value)+parseFloat(output.apb_success_value)).toFixed(4);

      let total_ach_amount =  (parseFloat(output.ach_failure_value)+parseFloat(output.ach_inprogress_value)+parseFloat(output.ach_success_value)).toFixed(4);

      let total_amount = (parseFloat(output.ach_failure_value)+parseFloat(output.ach_inprogress_value)+parseFloat(output.ach_success_value)
      +parseFloat(output.apb_failure_value)+parseFloat(output.apb_inprogress_beneficiaries_value)+parseFloat(output.apb_success_value)).toFixed(4);
    

      /*----------total card Amount---------*/
      

/*------------------------------------------------------------------------*/

            $('#card_total_count').text(numberWithCommas(total_count));
            $('#card_total_abp_count').text(numberWithCommas(total_apb_count));
            $('#card_total_ach_count').text(numberWithCommas(total_ach_count));

            $('#card_no_of_file_processed').text(numberWithCommas(card_no_of_file_processed));
            $('#card_no_of_records').text(numberWithCommas(card_no_of_records));
            $('#card_no_of_banks').text(numberWithCommas(card_no_of_banks));

            /*row 2 count card 1 */
              $('#card_total_success_count').text(numberWithCommas(card_total_success_count));
              $('#card_abp_success_count').text(numberWithCommas(card_abp_success_count));
              $('#card_ach_success_count').text(numberWithCommas(card_ach_success_count));

            /*row 2 count card 2*/
              $('#card_total_inprogress_count').text(numberWithCommas(card_total_inprogress_count));
              $('#card_abp_inprogress_count').text(numberWithCommas(output.apb_inprogress_count));
              $('#card_ach_inprogress_count').text(numberWithCommas(output.ach_inprogress_beneficiaries_count));

            /*row 2 count card 3*/
              $('#card_total_failure_count').text(numberWithCommas(card_total_failure_count));
              $('#card_abp_failure_count').text(numberWithCommas(output.apb_failure_beneficiaries_count));
              $('#card_ach_failure_count').text(numberWithCommas(output.ach_failure_beneficiaries_count));
/*------------------------------------------------------------------------*/

/*------------------------------------------------------------------------*/

        if(convertAmout=='crore'){
          /*row 3 count card 1*/
              $("#card_total_amount").text(numberWithCurrency(lakhsToCrores(total_amount)));
              $("#card_total_abp_amount").text(numberWithCurrency(lakhsToCrores(total_apb_amount)));
              $("#card_total_ach_amount").text(numberWithCurrency(lakhsToCrores(total_ach_amount)));
              
            /*row 3 count card 2*/
              $('#card_total_success_amount').text(numberWithCurrency(lakhsToCrores(card_total_success_amount)));
              $('#card_abp_success_amount').text(numberWithCurrency(lakhsToCrores(parseFloat(output.apb_success_value).toFixed(4))));
              $('#card_ach_success_amount').text(numberWithCurrency(lakhsToCrores(parseFloat(output.ach_success_value).toFixed(4))));

            /*row 3 count card 3*/
              $('#card_total_inprogress_amount').text(numberWithCurrency(lakhsToCrores(card_total_inprogress_amount)));
              $('#card_abp_inprogress_amount').text(numberWithCurrency(lakhsToCrores(parseFloat(output.apb_inprogress_beneficiaries_value).toFixed(4))));
              $('#card_ach_inprogress_amount').text(numberWithCurrency(lakhsToCrores(parseFloat(output.ach_inprogress_value).toFixed(4))));

            /*row 3 count card 3*/
              $('#card_total_failure_amount').text(numberWithCurrency(lakhsToCrores(card_total_failure_amount)));
              $('#card_abp_failure_amount').text(numberWithCurrency(lakhsToCrores(parseFloat(output.apb_failure_value).toFixed(4))));
              $('#card_ach_failure_amount').text(numberWithCurrency(lakhsToCrores(parseFloat(output.ach_failure_value).toFixed(4))));
          
        }else{
            /*row 3 count card 1*/
            $("#card_total_amount").text(numberWithCurrency(total_amount));
              $("#card_total_abp_amount").text(numberWithCurrency(total_apb_amount));
              $("#card_total_ach_amount").text(numberWithCurrency(total_ach_amount));


            /*row 3 count card 2*/
              $('#card_total_success_amount').text(numberWithCurrency(card_total_success_amount));
              $('#card_abp_success_amount').text(numberWithCurrency(parseFloat(output.apb_success_value).toFixed(4)));
              $('#card_ach_success_amount').text(numberWithCurrency(parseFloat(output.ach_success_value).toFixed(4)));

            /*row 3 count card 3*/
              $('#card_total_inprogress_amount').text(numberWithCurrency(card_total_inprogress_amount));
              $('#card_abp_inprogress_amount').text(numberWithCurrency(parseFloat(output.apb_inprogress_beneficiaries_value).toFixed(4)));
              $('#card_ach_inprogress_amount').text(numberWithCurrency(parseFloat(output.ach_inprogress_value).toFixed(4)));

            /*row 3 count card 3*/
              $('#card_total_failure_amount').text(numberWithCurrency(card_total_failure_amount));
              $('#card_abp_failure_amount').text(numberWithCurrency(parseFloat(output.apb_failure_value).toFixed(4)));
              $('#card_ach_failure_amount').text(numberWithCurrency(parseFloat(output.ach_failure_value).toFixed(4)));
        }
              
/*------------------------------------------------------------------------*/

             
            /*chart 1*/
            Total_ach_no_of_count = parseInt(output.ach_total_beneficiaries_count);
            Total_apb_no_of_count = parseInt(output.apb_total_beneficiaries_count);
            

            if(convertAmout=='crore'){
             /*chart 2*/
             Total_ach_no_of_amount = parseFloat(lakhsToCrores(output.ach_failure_value))+parseFloat(lakhsToCrores(output.ach_inprogress_value))+parseFloat(lakhsToCrores(output.ach_success_value));

             Total_apb_no_of_amount = parseFloat(lakhsToCrores(output.apb_failure_value))+parseFloat(lakhsToCrores(output.apb_inprogress_beneficiaries_value))+parseFloat(lakhsToCrores(output.apb_success_value));
            }else{
              /*chart 2*/
              Total_ach_no_of_amount = parseFloat(output.ach_failure_value)+parseFloat(output.ach_inprogress_value)+parseFloat(output.ach_success_value);

              Total_apb_no_of_amount = parseFloat(output.apb_failure_value)+parseFloat(output.apb_inprogress_beneficiaries_value)+parseFloat(output.apb_success_value);
            }


              var apexchartsStucture = [
                {
                  chartDiv:"chart1",
                  chartTypeArrived:['ACH', 'APB'],
                  chartValue:[Total_ach_no_of_count,Total_apb_no_of_count],
                },
                {
                  chartDiv:"chart2",
                  chartTypeArrived:['ACH', 'APB'],
                  chartValue:[Total_ach_no_of_amount,Total_apb_no_of_amount],
                }
              ]
              apexcharts(apexchartsStucture);
             setTimeout(() => {
              apexcharts(apexchartsStucture);
             }, 1000); 
          } else if (response.success == 0) {
              Swal.fire({
                  icon: "error",
                  title: response.message,
                  showConfirmButton: false,
                  timer: 2000
              })
          }
      },
      error: function () {
        Swal.fire({
            icon: "error",
            title: "Service Error!",
            showConfirmButton: false,
            timer: 2000
        })
      }
    });
  }


  function getDashboardDistinctBeneficiary(){
    var userDataString = getCookie('payment_official');
    userDataString = JSON.parse(userDataString)
    var loginUser_id = userDataString['user_id'];

    var dataFilters = window.localStorage.getItem('filters');
    $.ajax({
      url: APIURL + 'getDashboardDistinctBeneficiary', // Replace with your API endpoint
      method: 'POST', // Change the method to GET
      headers: {
          'X-APP-KEY': config.app_key,
          'X-APP-NAME': config.app_name
      },
      data: {
        fileters:dataFilters,
        user_id:loginUser_id
      },
      dataType: 'json',
      success: function (response) {
              let outputObject = [];
              if (response.success == 1) {
              response.data.forEach((item) => {
                for (const key in item) {
                  if (item.hasOwnProperty(key)) {
                    outputObject[key] = Number(item[key]);
                  }
                }
              });

              output = outputObject;

              $('#card_beneficiaries_total_count').text(numberWithCommas(output.distinct_beneficiary_count));
              $('#card_beneficiaries_inprogress_count').text(numberWithCommas(output.distinct_inprogress_count));
              $('#card_beneficiaries_success_count').text(numberWithCommas(output.distinct_success_count));
              $('#card_beneficiaries_failure_count').text(numberWithCommas(output.distinct_failure_count));
              $('#card_beneficiaries_emo_count').text(numberWithCommas(output.distinct_emo_count));

          } else if (response.success == 0) {
              Swal.fire({
                  icon: "error",
                  title: response.message,
                  showConfirmButton: false,
                  timer: 2000
              })
          }
      },
      error: function () {
        Swal.fire({
            icon: "error",
            title: "Service Error!",
            showConfirmButton: false,
            timer: 2000
        })
      }
    });
  }
  $('#ddl_year').on('change',function(){
    labelPaymentMonthEmpty();
  });

  function labelPaymentMonthEmpty(){
    $('#label_payment_date').empty();
    $('#label_payment_date').append($('<option>', {value: "", text: "--Please Select Payment Year Month--" }));
      $('#payment_date_input').val('');
  }

  function getpaymentDate(){
    $('#label_payment_date').empty();
    $('#label_payment_date').append($('<option>', {value: "", text: "--Payment Date Not Found--" }));
    var userDataString = getCookie('payment_official');
    userDataString = JSON.parse(userDataString)
    var loginUser_id = userDataString['user_id'];

    var dataFilters = window.localStorage.getItem('filters');
    $.ajax({
      url: APIURL + 'get_payment_date', // Replace with your API endpoint
      method: 'POST', // Change the method to GET
      headers: {
          'X-APP-KEY': config.app_key,
          'X-APP-NAME': config.app_name
      },
      data: {
        fileters:dataFilters,
        user_id:loginUser_id
      },
      dataType: 'json',
      success: function (response) {
              let outputObject = [];
        if (response.success == 1) {
              var payment_date = response.data;
              $('#label_payment_date').empty();
              $('#label_payment_date').append($('<option>', {
              value: "",
              text: "--All--"
              }));

              $.each(payment_date, function (index, datelist) {
              if(payment_date.length >1){
                $('#label_payment_date').append($('<option>', {
                    value: datelist.payment_date,
                    text: datelist.payment_date
                }));
              }else{
              $('#label_payment_date').append($('<option>', {
                  value: datelist.payment_date,
                  text: datelist.payment_date
                  }).prop('selected', true));
                }
              });
              $('#scheme_wise_dashboard').show();
          } else if (response.success == 0) {
            $('#scheme_wise_dashboard').hide();
              Swal.fire({
                  icon: "question",
                  title: response.message,
                  showConfirmButton: false,
                  timer: 4000
              })
          }
      },
      error: function () {
        Swal.fire({
            icon: "error",
            title: "Service Error!",
            showConfirmButton: false,
            timer: 2000
        })
      }
    });
  }

  $('#label_payment_date').on('change',function(){
      let payment_date = $('#label_payment_date').val();
      let payementTextAll = $('#label_payment_date :selected').text();
    if(payment_date!='' && payment_date!= null && payment_date!=undefined){
      $('#scheme_wise_dashboard').show();
    }
    else if(payementTextAll =='--All--'){
      $('#scheme_wise_dashboard').show();
    }
    else{
      $('#scheme_wise_dashboard').hide();
    }
      $('#payment_date_input').val(payment_date);
      $('#formFilters').submit();
  });

  function getDashboardBeneficiarySummary(){
    var userDataString = getCookie('payment_official');
    userDataString = JSON.parse(userDataString)
    var loginUser_id = userDataString['user_id'];

    var dataFilters = window.localStorage.getItem('filters');
    $.ajax({
      url: APIURL + 'getDashboardDistinctSummary', // Replace with your API endpoint
      method: 'POST', // Change the method to GET
      headers: {
          'X-APP-KEY': config.app_key,
          'X-APP-NAME': config.app_name
      },
      data: {
        fileters:dataFilters,
        user_id:loginUser_id
      },
      dataType: 'json',
      success: function (response) {
              let outputObject = [];
              if (response.success == 1) {
              response.data.forEach((item) => {
                for (const key in item) {
                  if (item.hasOwnProperty(key)) {
                    outputObject[key] = Number(item[key]);
                  }
                }
              });

              output = outputObject;

let card_valid_invalid_total_count = parseInt(output.valid_records)+parseInt(output.invalid_records);
let card_pending_tranfered_total_count = parseInt(output.pending_records)+parseInt(output.transferred_records);


let card_processed_count = parseInt(output.total_records) - parseInt(output.pending_records);
let card_no_proccessed_count = parseInt(output.total_records) - parseInt(card_processed_count);

$('#card_data_received_count').text(numberWithCommas(parseInt(output.total_records)));
$('#card_processed_count').text(numberWithCommas(card_processed_count));
$('#card_no_proccessed_count').text(numberWithCommas(card_no_proccessed_count));

$('#card_valid_invalid_total_count').text(numberWithCommas(card_valid_invalid_total_count));
$('#card_valid_count').text(numberWithCommas(parseInt(output.valid_records)));
$('#card_invalid_count').text(numberWithCommas(parseInt(output.invalid_records)));

$('#card_pending_tranfered_total_count').text(numberWithCommas(card_pending_tranfered_total_count));
$('#card_pending_count').text(numberWithCommas(parseInt(output.pending_records)));
$('#card_Transferred_count').text(numberWithCommas(parseInt(output.transferred_records)));


$('#card_total_invalid_count').text(numberWithCommas(parseInt(output.invalid_records)));
$('#card_aadhar_invalid_count').text(numberWithCommas(parseInt(output.invalid_aadhaar)));
$('#card_ac_invalid_count').text(numberWithCommas(parseInt(output.invalid_account)));
$('#card_iin_ifsc_invalid_count').text(numberWithCommas(parseInt(output.invalid_iin_or_ifsc)));
$('#card_obsolete_invalid_count').text(numberWithCommas(parseInt(output.obsolete_beneficiary)));



let totalduplicatecount = parseInt(output.duplicate_aadhaar_present)+parseInt(output.duplicate_account_present)+parseInt(output.duplicate_benificiary);

$('#card_in_valid_total_duplicate_count').text(numberWithCommas(totalduplicatecount));
$('#card_total_duplicate_count').text(numberWithCommas(totalduplicatecount));
$('#card_aadhar_duplicate_count').text(numberWithCommas(parseInt(output.duplicate_aadhaar_present)));
$('#card_ac_duplicate_count').text(numberWithCommas(parseInt(output.duplicate_account_present)));
$('#card_duplicate_beneficiary_count').text(numberWithCommas(parseInt(output.duplicate_benificiary)));


          } else if (response.success == 0) {
              Swal.fire({
                  icon: "error",
                  title: response.message,
                  showConfirmButton: false,
                  timer: 2000
              })
          }
      },
      error: function () {
        Swal.fire({
            icon: "error",
            title: "Service Error!",
            showConfirmButton: false,
            timer: 2000
        })
      }
    });
  }

  
  let chart;
  function apexcharts(chartsArr){
    if (chart) {
      chart.destroy();
    }
    chartsArr.forEach(chartsData => {
      var options = {
          series: chartsData.chartValue,
          chart: {
            width: 380,
            type: 'pie',
          },
          labels: chartsData.chartTypeArrived,
          responsive: [{
            breakpoint: 480,
            options: {
              chart: {
                width: 250
              },
              legend: {
                position: 'bottom'
              }
            }
          }]
        };
        var chart = new ApexCharts(document.querySelector("#"+chartsData.chartDiv), options);
        chart.render();
    });
  }




    function numberWithCommas(x) {
            return x.toLocaleString('en-IN');
    }

    function numberWithCurrency(x){
      var numString = x.toString();
        
            return '₹ '+x.toLocaleString('en-IN');
       
    }

  function getYearMonth(dateStr) {
      var dateObj = new Date(dateStr);
      var year = dateObj.getFullYear();
      var month = dateObj.getMonth() + 1;
      var monthStr = month < 10 ? '0' + month : month.toString();
      return { year: year, month: monthStr };
  }

  function processDates(fromDateStr, toDateStr) {
      var fromDate = getYearMonth(fromDateStr);
      var toDate = getYearMonth(toDateStr);
      return {
          from: fromDate,
          to: toDate
      };
  }
  // changeLakshandCrore('laksh');
  function changeLakshandCrore(convert){
    if(convert=='laksh'){
      getDashboard(convert);
      $('#set_amount_convertion').text('Laksh');
    }else if(convert=='crore'){
      getDashboard(convert);
      $('#set_amount_convertion').text('Crore');
    }

  }

  function lakhsToCrores(lakhs) {
    let lakshss = parseFloat(lakhs).toFixed(4);
    return lakshss / 100;
}

function checkCurrentMonth() {
  var currentDate = new Date();
  var currentMonth = currentDate.getMonth() + 1; 
  var currentYear = currentDate.getFullYear().toString();

  return {
    'currentMonth': currentMonth < 10 ? '0' + currentMonth : currentMonth.toString(),
    'currentYear': currentYear
  };
}




function get_schemebyuser(userid){

  // alert(userid);
  let ddl_scheme_cate = $('#ddl_scheme_cate').val();
  let ddl_scheme_code = $('#ddl_scheme_code').val();
  let ddl_scheme_name = $('#ddl_scheme_name').val();
  let ddl_sub_scheme = $('#ddl_sub_scheme').val();
  let ddl_department = $('#ddl_department').val();
  let ddl_sub_department = $('#ddl_sub_department').val();

  $('#ddl_payment_period').empty();

    $('#ddl_payment_cycle').text('');
    $('#payment_cycle_hidden').val('');

      // var department = $('#ddl_department').val();
      $.ajax({
      url: APIURL +'get_scheme_by_user',
      type: "POST",
      headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
      data: {user_id:userid,ddl_scheme_cate:ddl_scheme_cate,ddl_scheme_code:ddl_scheme_code,ddl_scheme_name:ddl_scheme_name,ddl_sub_scheme:ddl_sub_scheme,ddl_department:ddl_department,ddl_sub_department:ddl_sub_department},
      success: function(response) {
          // console.log("Success:",JSON.parse(response)[0].data );
          if(response.success == 1){

          var output = response.data[0];
        $('#ddl_payment_cycle').text(output.payment_cycle_text);
        $('#payment_cycle_hidden').val(output.payment_cycle);

        // get_schemebyuserPaymentPeriod(userid,paymentcycle,paymentperiod,iinstallment);
        bindDropDownList(output.payment_cycle_text,'#ddl_payment_period');


          }else{
          console.log("Error:", response);
          }
        
      },
      error: function(xhr, status, error) {
          console.log("Error:", error);
          // Handle the error here
      }
    });
}

function bindDropDownList(type,element){
  var userDataString = getCookie('payment_official');
  userDataString = JSON.parse(userDataString);
  window.loginUser_id = userDataString['user_id'];

      $('#ddl_payment_installment').empty();
      $('#ddl_year').empty();
      
      $('#ddl_year').append($('<option>', {
          value: "",
          text: "Select Year - Month"
      }).attr('disabled','true').attr('selected', 'selected'));

      $('#ddl_payment_installment').append($('<option>', {
          value: "",
          text: "Select Installment"
      }).attr('disabled','true').attr('selected', 'selected'));

      if (typeof type === 'object') {
        type = type[0];
      }

    $.ajax({
      url: APIURL +'fn_general_getdropdownvalues',
      type: "POST",
      headers: {'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
      data: {user_id: loginUser_id,dropdown_type:type},
      success: function(response) {
        console.log(response.data);
      
          var dropdownList = response.data;
          if(response.success ==1){
            $(element).show();
            $(element+'_col').show();
          $(element).empty();
          $(element).append($('<option>', {
                value: "",
                text: "Select "+type
            }));
          // Iterate over the JSON object and append options
          $.each(dropdownList, function (index, dep) {
            $(element).append($('<option>', {
                value: dep.id,
                text: dep.display_text
            }));
          });
        }else{
          $(element).empty();
          if(element!=null && element!=''&&element!=undefined){
            $(element).hide();
            $(element+'_col').hide();
          }

          if(type=='Monthly' || type=='Yearly'){
            get_instalment_filter();
          }
        }
      },
      error: function(xhr, status, error) {
          console.log("Error:", error);
          // Handle the error here
      }
    });
}


$('#ddl_payment_period').on('change',function(){
  get_instalment_filter();
});


function get_instalment_filter(){
  
  $('#ddl_payment_installment').empty();
  $('#ddl_payment_installment').append($('<option>', {
          value: "",
          text: "Select Installment"
      }).attr('disabled','true').attr('selected', 'selected'));
  $('#ddl_year').empty();
  $('#ddl_year').append($('<option>', {
      value: "",
      text: "Select Year - Month"
  }).attr('disabled','true').attr('selected', 'selected'));


  var userDataString = getCookie('payment_official');
  userDataString = JSON.parse(userDataString);
  window.loginUser_id = userDataString['user_id'];
    
  let ddl_scheme_cate = $('#ddl_scheme_cate').val();
  let ddl_scheme_code = $('#ddl_scheme_code').val();
  let ddl_scheme_name = $('#ddl_scheme_name').val();
  let ddl_sub_scheme = $('#ddl_sub_scheme').val();
  let ddl_department = $('#ddl_department').val();
  let ddl_sub_department = $('#ddl_sub_department').val();
  let ddl_payment_period = $('#ddl_payment_period').val();
  let ddl_payment_cycle = $('#payment_cycle_hidden').val();
  
  if(ddl_payment_period=='' || ddl_payment_period==null||ddl_payment_period==undefined){
    ddl_payment_period = -1;
  }

    $.ajax({
     url: APIURL +'get_installment_filter',
     type: "POST",
     headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
     data: {user_id:loginUser_id,ddl_scheme_cate:ddl_scheme_cate,ddl_scheme_code:ddl_scheme_code,ddl_scheme_name:ddl_scheme_name,ddl_sub_scheme:ddl_sub_scheme,ddl_department:ddl_department,ddl_sub_department:ddl_sub_department,paymentcycle:ddl_payment_cycle,paymentperiod:ddl_payment_period},
     success: function(response) {

         if(response.success == 1){
          var output = response.data;

          console.log('ouput >>>', output);

              let installment = fetchDropdownValues('Installment');
              installment.then(function(arrayValue) {
              let grounList = [];

              output.forEach(element => {
                grounList.push(element.installments);
              });

              let instamentList = arrayValue.filter(item => grounList.includes(item.id));
            
              $('#ddl_payment_installment').empty();
              
                console.log('instamentList length', instamentList.length);
                if(instamentList.length==1){
                  instamentList.forEach(list => {                 
                  $('#ddl_payment_installment').append($('<option>', {
                    value: list.value,
                    text: list.display_text
                  }).attr('selected','selected'));
                  $('#ddl_payment_installment').change();
                });
                }else{
                  $('#ddl_payment_installment').append($('<option>', { value: "",text: "Select Installment"}).attr('disabled','true').attr('selected', 'selected'));
                    instamentList.forEach(list => {                 
                    $('#ddl_payment_installment').append($('<option>', {
                      value: list.value,
                      text: list.display_text
                    }));
                  });
                }
                

              });
         }else{
          console.log("Error:", response);
         }
         
      
     },
     error: function(xhr, status, error) {
         console.log("Error:", error);
         // Handle the error here
     }
   });
}



$('#ddl_payment_installment').on('change',function(){
  let instalmment_value = $('#ddl_payment_installment').val();
  
  if(instalmment_value!='' || instalmment_value!=null){
      let installment_txt_value = $('#ddl_payment_installment option:selected').text();
      
      $('#installment_txt_value').val(installment_txt_value);
  }else{
      let installment_txt_value = '';
      $('#installment_txt_value').val(installment_txt_value);
  }
  

  $('#ddl_year').empty();
      
      $('#ddl_year').append($('<option>', {
          value: "",
          text: "Select Year - Month"
      }).attr('disabled','true').attr('selected', 'selected'));

var userDataString = getCookie('payment_official');
userDataString = JSON.parse(userDataString);
window.loginUser_id = userDataString['user_id'];
  
let ddl_scheme_cate = $('#ddl_scheme_cate').val();
let ddl_scheme_code = $('#ddl_scheme_code').val();
let ddl_scheme_name = $('#ddl_scheme_name').val();
let ddl_sub_scheme = $('#ddl_sub_scheme').val();
let ddl_department = $('#ddl_department').val();
let ddl_sub_department = $('#ddl_sub_department').val();
let ddl_payment_period = $('#ddl_payment_period').val();
let ddl_payment_cycle = $('#payment_cycle_hidden').val();
let ddl_payment_installment = $('#ddl_payment_installment').val();
if(ddl_payment_period=='' || ddl_payment_period==null||ddl_payment_period==undefined){
    ddl_payment_period = -1;
  }
  $.ajax({
   url: APIURL +'get_year_filter',
   type: "POST",
   headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
   data: {user_id:loginUser_id,ddl_scheme_cate:ddl_scheme_cate,ddl_scheme_code:ddl_scheme_code,ddl_scheme_name:ddl_scheme_name,ddl_sub_scheme:ddl_sub_scheme,ddl_department:ddl_department,ddl_sub_department:ddl_sub_department,paymentcycle:ddl_payment_cycle,paymentperiod:ddl_payment_period,iinstallment:ddl_payment_installment},
   success: function(response) {

       if(response.success == 1){
        var output = response.data;
        // Iterate over the JSON object and append options
        $.each(output, function (index, list) {
            // if(sub_dep.sub_department_code==subDepID){ 
              $('#ddl_year').append($('<option>', {
                value: list.yyyymm,
                text: list.yyyymm_text
            }));
          // }
        });
       }else{
        console.log("Error:", response);
       }
       
    
   },
   error: function(xhr, status, error) {
       console.log("Error:", error);
       // Handle the error here
   }
 });
});


async function dropDownList(type) {
  try {
      var userDataString = getCookie('payment_official');
      userDataString = JSON.parse(userDataString);
      window.loginUser_id = userDataString['user_id'];

      const response = await $.ajax({
          url: APIURL + 'fn_general_getdropdownvalues',
          type: "POST",
          headers: { 'X-APP-KEY': config.app_key, 'X-APP-NAME': config.app_name },
          data: { user_id: loginUser_id, dropdown_type: type }
      });

      // console.log(response.data);
      return response.data;
  } catch (error) {
      console.error("Error:", error);
      throw error;
  }
}

async function fetchDropdownValues(type) {
  try {
      let getDropDown = await dropDownList(type);
      // console.log(`type >>`, getDropDown);
      return getDropDown;
  } catch (error) {
      console.error('Error occurred:', error);
  }
}

$('#scheme_wise_dashboard').hide();
$('#filter_based_info_card_div').hide();





  </script>
  </body>
  </html>